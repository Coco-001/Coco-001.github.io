<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>MySQL基础整理 | cocospace</title><meta name="author" content="Coco"><meta name="copyright" content="Coco"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="检索语句（SELECT）单列检索123SELECT user_name FROM user;  检索多个列123SELECT user_id, user_name FROM user；  检索所有列123SELECT * FROM user;  注意：除非必要，不要使用通配符*进行检索，这会降低检索和应用程序的性能。 检索不同的行123SELECT DISTINCT user_nameFROM u">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL基础整理">
<meta property="og:url" content="http://www.cocospace.top/2022/04/25/MySQL/index.html">
<meta property="og:site_name" content="cocospace">
<meta property="og:description" content="检索语句（SELECT）单列检索123SELECT user_name FROM user;  检索多个列123SELECT user_id, user_name FROM user；  检索所有列123SELECT * FROM user;  注意：除非必要，不要使用通配符*进行检索，这会降低检索和应用程序的性能。 检索不同的行123SELECT DISTINCT user_nameFROM u">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://encylia.com/wp-content/uploads/2014/03/MySQL-Logo.jpg">
<meta property="article:published_time" content="2022-04-24T16:00:00.000Z">
<meta property="article:modified_time" content="2023-03-09T12:27:25.190Z">
<meta property="article:author" content="Coco">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://encylia.com/wp-content/uploads/2014/03/MySQL-Logo.jpg"><link rel="shortcut icon" href="https://himg.bdimg.com/sys/portrait/item/public.1.c9c27b67.T8_jvMBtFmm5HndCatP7rA.jpg"><link rel="canonical" href="http://www.cocospace.top/2022/04/25/MySQL/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Coco","link":"链接: ","source":"来源: cocospace","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQL基础整理',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-09 20:27:25'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://himg.bdimg.com/sys/portrait/item/public.1.c9c27b67.T8_jvMBtFmm5HndCatP7rA.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">36</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url('https://encylia.com/wp-content/uploads/2014/03/MySQL-Logo.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="cocospace"><span class="site-name">cocospace</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MySQL基础整理</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-04-24T16:00:00.000Z" title="发表于 2022-04-25 00:00:00">2022-04-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-09T12:27:25.190Z" title="更新于 2023-03-09 20:27:25">2023-03-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0/">数据库学习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="MySQL基础整理"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="检索语句（SELECT）"><a href="#检索语句（SELECT）" class="headerlink" title="检索语句（SELECT）"></a>检索语句（SELECT）</h2><h3 id="单列检索"><a href="#单列检索" class="headerlink" title="单列检索"></a>单列检索</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_name </span><br><span class="line"></span><br><span class="line">FROM user;</span><br></pre></td></tr></table></figure>

<h3 id="检索多个列"><a href="#检索多个列" class="headerlink" title="检索多个列"></a>检索多个列</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name </span><br><span class="line"></span><br><span class="line">FROM user；</span><br></pre></td></tr></table></figure>

<h3 id="检索所有列"><a href="#检索所有列" class="headerlink" title="检索所有列"></a>检索所有列</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line"></span><br><span class="line">FROM user;</span><br></pre></td></tr></table></figure>

<p>注意：除非必要，不要使用通配符*进行检索，这会降低检索和应用程序的性能。</p>
<h3 id="检索不同的行"><a href="#检索不同的行" class="headerlink" title="检索不同的行"></a>检索不同的行</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT DISTINCT user_name</span><br><span class="line"></span><br><span class="line">FROM user;</span><br></pre></td></tr></table></figure>

<p>注意：不能部分使用DISTINCT。</p>
<h3 id="限制结果"><a href="#限制结果" class="headerlink" title="限制结果"></a>限制结果</h3><ol>
<li><p>限制输出检索结果的前五行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">LIMIT 5;</span><br></pre></td></tr></table></figure>

<p>注意：结果是输出第0到4行</p>
</li>
<li><p>获取检索结果的指定行[5,10)。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">LIMIT 5, 5;</span><br></pre></td></tr></table></figure>

<p>注意：由1注意可知LIMIT1,1得到的是第二行而不是第一行[1,2)。</p>
</li>
</ol>
<h3 id="使用完全限定的表名"><a href="#使用完全限定的表名" class="headerlink" title="使用完全限定的表名"></a>使用完全限定的表名</h3><ol>
<li><p>列名完全限定（指定是user表中的user_id列）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT user.user_id</span><br><span class="line"></span><br><span class="line">FROM user;</span><br></pre></td></tr></table></figure>


</li>
<li><p>表名完全限定（指定是shop数据库中的user表，且指定是user表中的user_id列）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT user.user_id</span><br><span class="line"></span><br><span class="line">FROM shop.user;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>注意：完全限定的好处也是能够提升检索效率，优化检索和应用程序的使用体验。</p>
<h2 id="排序检索语句"><a href="#排序检索语句" class="headerlink" title="排序检索语句"></a>排序检索语句</h2><h3 id="排序数据"><a href="#排序数据" class="headerlink" title="排序数据"></a>排序数据</h3><p>字句（clause）：SQL语句由子句构成，有些子句是必需的，而有的是可选的。一个子句通常由一个关键字和所提供的数据组成。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_name</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">ORDER BY user_name;</span><br></pre></td></tr></table></figure>

<p>注意：通过非选择列进行排序通常，ORDER BY子句中使用的列将是为显示所选择的列。但是，实际上并不一定要这样，用非检索的列排序数据是完全合法的。</p>
<h3 id="按多个列排序"><a href="#按多个列排序" class="headerlink" title="按多个列排序"></a>按多个列排序</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name, user_sex</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">ORDER BY user_name, user_sex;</span><br></pre></td></tr></table></figure>

<p>解释：将检索结果先按user_name排序，当user_name值相同时，再按user_sex排序。</p>
<h3 id="指定排序方向"><a href="#指定排序方向" class="headerlink" title="指定排序方向"></a>指定排序方向</h3><p><strong>降序</strong>（默认为升序）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name, user_sex</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">ORDER BY user_id DESC;</span><br></pre></td></tr></table></figure>

<p><strong>同时使用升降序</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name, user_sex</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">ORDER BY user_id DESC, user_name;</span><br></pre></td></tr></table></figure>

<p>先按user_id降序排序，再按姓名升序排序</p>
<p>注意：如果要在多个列上使用降序排列，必须对每个列指定DESC关键字。</p>
<p><strong>使用ORDER BY和LIMIT的组合，可以找出一个列中最高或最低的值</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_age</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">ORDER BY user DESC</span><br><span class="line"></span><br><span class="line">LIMIT 1;</span><br></pre></td></tr></table></figure>

<p>以上语句可以返回user表中年龄最大用户。</p>
<h2 id="过滤数据"><a href="#过滤数据" class="headerlink" title="过滤数据"></a>过滤数据</h2><h3 id="使用WHERE字句"><a href="#使用WHERE字句" class="headerlink" title="使用WHERE字句"></a>使用WHERE字句</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">WHERE user_age = 20;</span><br></pre></td></tr></table></figure>

<p><strong>WHERE子句的位置：</strong></p>
<p>注意：在同时使用ORDER BY和WHERE子句时，应该让ORDERBY位于WHERE之后，否则将会产生错误。</p>
<h3 id="WHERE字句操作符"><a href="#WHERE字句操作符" class="headerlink" title="WHERE字句操作符"></a>WHERE字句操作符</h3><p>&#x3D; 等于；&lt;&gt;、!&#x3D;不等于；BETWEEN在指定的区间</p>
<h3 id="检查单个字（-gt-、-lt-、-gt-x3D-、-lt-x3D-、-x3D-、-lt-gt-）"><a href="#检查单个字（-gt-、-lt-、-gt-x3D-、-lt-x3D-、-x3D-、-lt-gt-）" class="headerlink" title="检查单个字（&gt;、&lt;、&gt;&#x3D;、&lt;&#x3D;、!&#x3D;、&lt;&gt;）"></a>检查单个字（&gt;、&lt;、&gt;&#x3D;、&lt;&#x3D;、!&#x3D;、&lt;&gt;）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">WHERE user_name = &quot;coco&quot;;</span><br></pre></td></tr></table></figure>

<h3 id="范围检查"><a href="#范围检查" class="headerlink" title="范围检查"></a>范围检查</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">WHERE user_age BETWEEN 18 AND 20;</span><br></pre></td></tr></table></figure>

<p>注意：BETWEEN会匹配范围中的所有值，在本例中即匹配[18,20]。</p>
<h3 id="空值检查（注意NULL与不匹配）"><a href="#空值检查（注意NULL与不匹配）" class="headerlink" title="空值检查（注意NULL与不匹配）"></a>空值检查（注意NULL与不匹配）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">WHERE user_age IS NULL;</span><br></pre></td></tr></table></figure>

<p><strong>NULL与不匹配：</strong>在通过过滤选择出不具有特定值的行时,你可能希望返回具有NULL值的行。但是，不行。因为未知具有特殊的含义，数据库不知道它们是否匹配，所以在匹配过滤或不匹配过滤时不返回它们。<br>因此，在过滤数据时，一定要验证返回数据中确实给出了被过滤列具有NULL的行。</p>
<p>例如数据库user表中存在user_age大于10，小于10和空的列，进行如下操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM user where user_age &lt;&gt; 10;</span><br></pre></td></tr></table></figure>

<p>该操作会返回所有除user_age为空并且user_age不等于10的列，但是NULL值不参与匹配，</p>
<h2 id="数据过滤"><a href="#数据过滤" class="headerlink" title="数据过滤"></a>数据过滤</h2><h3 id="组合WHERE字句"><a href="#组合WHERE字句" class="headerlink" title="组合WHERE字句"></a><strong>组合WHERE字句</strong></h3><h4 id="AND操作符"><a href="#AND操作符" class="headerlink" title="AND操作符"></a><strong>AND操作符</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">WHERE user_id = 1001 AND user_age &lt;= 20;</span><br></pre></td></tr></table></figure>



<h4 id="OR操作符"><a href="#OR操作符" class="headerlink" title="OR操作符"></a><strong>OR操作符</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">WHERE user_id = 1001 OR user_id = 1002;</span><br></pre></td></tr></table></figure>



<h4 id="IN操作符"><a href="#IN操作符" class="headerlink" title="IN操作符"></a><strong>IN操作符</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">WHERE user_id IN （1001,1002） //等价于WHERE user_id =1001 OR user_id = 1002</span><br><span class="line"></span><br><span class="line">ORDER BY user_id;</span><br></pre></td></tr></table></figure>

<p><strong>注意：为什么要使用IN操作符?其优点具体如下：</strong><br>在使用长的合法选项清单时，IN操作符的语法更清楚且更直观。在使用IN时，计算的次序更容易管理（因为使用的操作符更少)。IN操作符一般比OR操作符清单执行更快。IN的最大优点是可以包含其他SELECT语句，使得能够更动态地建立WHERE子句。</p>
<h4 id="NOT操作符"><a href="#NOT操作符" class="headerlink" title="NOT操作符"></a><strong>NOT操作符</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">WHERE user_id NOT IN （1001,1002） //等价于WHERE user_id !=1001 OR user_id != 1002</span><br><span class="line"></span><br><span class="line">ORDER BY user_id;</span><br></pre></td></tr></table></figure>



<h3 id="用通配符进行过滤"><a href="#用通配符进行过滤" class="headerlink" title="用通配符进行过滤"></a>用通配符进行过滤</h3><h4 id="LIKE操作符"><a href="#LIKE操作符" class="headerlink" title="LIKE操作符"></a>LIKE操作符</h4><h4 id="通配符"><a href="#通配符" class="headerlink" title="%通配符"></a>%通配符</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">WHERE user_name LIKE &quot;shan%&quot;; //可以在任意位置使用%，如WHERE user_name LIKE &quot;%an%&quot;；</span><br></pre></td></tr></table></figure>

<p><strong>%表示任何字符出现任意次数</strong>，即上述语句表示匹配user_name为shan开头的列，<strong>但不可以匹配NULL，即使是WHERE user_name LIKE “%”也不可以</strong></p>
<p>注意：尾空格可能干扰匹配，如采用“%an”，对于“11an ”将不会被匹配，因为存在尾空格。</p>
<h4 id="下划线，-通配符"><a href="#下划线，-通配符" class="headerlink" title="下划线，_通配符"></a>下划线，_通配符</h4><p>匹配单个字符，其余规则与%通配符一致</p>
<h4 id="使用通配符的技巧"><a href="#使用通配符的技巧" class="headerlink" title="使用通配符的技巧"></a>使用通配符的技巧</h4><ol>
<li><p>不要过度使用通配符。如果其他操作符能达到相同的目的，应该使用其他操作符。</p>
</li>
<li><p>在确实需要使用通配符时，除非绝对有必要，否则不要把它们用在搜索模式的开始处。把通配符置于搜索模式的开始处，搜索起来是最慢的。</p>
</li>
<li><p>仔细注意通配符的位置。如果放错地方，可能不会返回想要的数据。</p>
<p>总之就是尽量减少通配符的使用，即使必须要用，也要尽量避免将它们用在搜索模式的开始处。</p>
</li>
</ol>
<h4 id="用正则表达式进行搜索"><a href="#用正则表达式进行搜索" class="headerlink" title="用正则表达式进行搜索"></a>用正则表达式进行搜索</h4><h3 id="使用MySQL正则表达式"><a href="#使用MySQL正则表达式" class="headerlink" title="使用MySQL正则表达式"></a>使用MySQL正则表达式</h3><p><strong>注意：MySQL只支持部分正则表达式，且MySQL正则匹配默认不区分大小写，如果需要区分大小写，则需要使用REGRXP BINARY</strong></p>
<h4 id="基本字符匹配"><a href="#基本字符匹配" class="headerlink" title="基本字符匹配"></a>基本字符匹配</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name`</span><br><span class="line"></span><br><span class="line">`FROM user`</span><br><span class="line"></span><br><span class="line">`WHERE user_name REGRXP &#x27;1000&#x27; //检索user_name包含1000的所有行`</span><br><span class="line"></span><br><span class="line">`ORDER BY user_id;</span><br></pre></td></tr></table></figure>

<p>可以在正则中使用“.000”，其中的点为匹配任意单个字符。</p>
<p>注意：LIKE与正则在匹配时存在差异，具体表现在正则匹配会同时进行精确匹配和近似匹配，即查找返回部分符合和完全符合表达式的值，而LIKE只返回近似匹配得到值。</p>
<p>如：正则匹配“.000”和LIKE “1000”，正则可以匹配到值“1000”，而LIKE会略过此项。</p>
<h4 id="进行OR匹配"><a href="#进行OR匹配" class="headerlink" title="进行OR匹配"></a>进行OR匹配</h4><p><code>SELECT user_id, user_name</code></p>
<p><code>FROM user</code></p>
<p><code>WHERE user_name REGRXP &quot;1000|1001&quot; //检索user_name包含1000或者包含1001的所有行</code></p>
<p><code>ORDER BY user_id;</code></p>
<h4 id="匹配几个字符之一"><a href="#匹配几个字符之一" class="headerlink" title="匹配几个字符之一"></a>匹配几个字符之一</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name`</span><br><span class="line"></span><br><span class="line">`FROM user`</span><br><span class="line"></span><br><span class="line">`WHERE user_name REGRXP &#x27;[123]Tom&#x27; //[123]表示匹配其中的一个，[^123]表示匹配除了123的其它任何东西`</span><br><span class="line"></span><br><span class="line">`ORDER BY user_id;</span><br></pre></td></tr></table></figure>

<h4 id="匹配范围"><a href="#匹配范围" class="headerlink" title="匹配范围"></a>匹配范围</h4><p>同上，[1-9]、[3-6]、[a-z]表示匹配该范围的所有数值&#x2F;字符。</p>
<h4 id="匹配特殊字符"><a href="#匹配特殊字符" class="headerlink" title="匹配特殊字符"></a>匹配特殊字符</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\\ 用来转义，如要匹配.则需要使用\\.同理匹配-，|等也是如此</span><br></pre></td></tr></table></figure>

<h4 id="匹配字符类"><a href="#匹配字符类" class="headerlink" title="匹配字符类"></a>匹配字符类</h4><p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220426152215049.png" alt="image-20220426152215049"></p>
<h4 id="匹配多个实例"><a href="#匹配多个实例" class="headerlink" title="匹配多个实例"></a>匹配多个实例</h4><p>目前为止使用的所有正则表达式都试图匹配单次出现。如果存在一个匹配，该行被检索出来，如果不存在，检索不出任何行。但有时需要对匹配的数目进行更强的控制。例如，你可能需要寻找所有的数，不管数中包含多少数字，或者你可能想寻找一个单词并且还能够适应一个尾随的s (如果存在)，等等。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220426152821471.png" alt="image-20220426152821471"></p>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name`</span><br><span class="line"></span><br><span class="line">`FROM user`</span><br><span class="line"></span><br><span class="line">`WHERE user_name REGRXP &#x27;\\([0-9]sticks?\\)&#x27; //其中\\(和\\)匹配(和)，[0-9]匹配0-9，sticks?匹配stick和sticks</span><br><span class="line"></span><br><span class="line">`ORDER BY user_id;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name`</span><br><span class="line"></span><br><span class="line">`FROM user`</span><br><span class="line"></span><br><span class="line">`WHERE user_name REGRXP &#x27;[[:digit:]]&#123;4&#125;&#x27; //其中[:digit:]表示匹配任意数字，&#123;4&#125;前面进行四次匹配，效果同[0-9][0-9][0-9][0-9]</span><br><span class="line"></span><br><span class="line">`ORDER BY user_id;</span><br></pre></td></tr></table></figure>

<h4 id="定位符"><a href="#定位符" class="headerlink" title="定位符"></a>定位符</h4><p>能够匹配特定位置的文本。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220426153649529.png" alt="image-20220426153649529"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id, user_name`</span><br><span class="line"></span><br><span class="line">`FROM user`</span><br><span class="line"></span><br><span class="line">`WHERE user_name REGRXP &#x27;^[0-9\\.]&#x27; //表示匹配以0-9或者小数点开头的字符串</span><br><span class="line"></span><br><span class="line">`ORDER BY user_id;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220426155147046.png" alt="image-20220426155147046"></p>
<h3 id="创建计算字段"><a href="#创建计算字段" class="headerlink" title="创建计算字段"></a>创建计算字段</h3><h4 id="计算字段"><a href="#计算字段" class="headerlink" title="计算字段"></a>计算字段</h4><h4 id="拼接字段"><a href="#拼接字段" class="headerlink" title="拼接字段"></a>拼接字段</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//MySQL可以使用Concat()函数来拼接两个列，一下示例表示拼接查询结果</span><br><span class="line"></span><br><span class="line">SELECT Concat（user_name, &#x27; ( &#x27; , user_sex, &#x27; ) &#x27;）//这里可以使用Trim（user_sex）去掉user_sex值左右两端的空格</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">ORDER BY user_name;</span><br></pre></td></tr></table></figure>

<p>同理还有LTrim和RTrim函数，可以分别去除左边的空格和右边的空格。</p>
<h4 id="使用别名"><a href="#使用别名" class="headerlink" title="使用别名"></a>使用别名</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//MySQL可以使用Concat()函数来拼接两个列，一下示例表示拼接查询结果</span><br><span class="line"></span><br><span class="line">SELECT Concat（user_name, &#x27; ( &#x27; , user_sex, &#x27; ) &#x27;） AS user_info//给检索结果的列名取了一个别名（有时也叫导出列），展示出来更好看</span><br><span class="line"></span><br><span class="line">FROM user</span><br><span class="line"></span><br><span class="line">ORDER BY user_name;</span><br></pre></td></tr></table></figure>

<h4 id="执行算数计算"><a href="#执行算数计算" class="headerlink" title="执行算数计算"></a>执行算数计算</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">SELECT product_id,</span><br><span class="line">       product_name,</span><br><span class="line">       item_price,</span><br><span class="line">       quantity,</span><br><span class="line">       item_price*quantity AS sum_price //进行算术运算生成新列，该列可以被使用</span><br><span class="line"></span><br><span class="line">FROM product</span><br><span class="line"></span><br><span class="line">WHERE product_id = 1001;</span><br></pre></td></tr></table></figure>

<h3 id="使用函数"><a href="#使用函数" class="headerlink" title="使用函数"></a>使用函数</h3><h4 id="常见时间函数"><a href="#常见时间函数" class="headerlink" title="常见时间函数"></a>常见时间函数</h4><p>当前时间NOW（）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/v2-a22046f7ad51ba0919d8340ca0dd3062_720w.jpg" alt="img"></p>
<h4 id="常见数学函数"><a href="#常见数学函数" class="headerlink" title="常见数学函数"></a>常见数学函数</h4><p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/v2-b0ef1b8485448264bcf68bddc10b97b8_720w.jpg" alt="img"></p>
<h4 id="常见字符函数"><a href="#常见字符函数" class="headerlink" title="常见字符函数"></a>常见字符函数</h4><p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/v2-a39bbf24f6f8cca42b4119f1de69f0bc_720w.jpg" alt="img"></p>
<h4 id="常见控制函数"><a href="#常见控制函数" class="headerlink" title="常见控制函数"></a>常见控制函数</h4><p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/v2-412e145ebc86a6a2dcac87366c6357fe_720w.jpg" alt="img"></p>
<p>示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select *,</span><br><span class="line">(case when score&lt;60 then &quot;不及格&quot;</span><br><span class="line">when score&gt;=60 and score&lt;70 then &quot;合格&quot;</span><br><span class="line">when score&gt;=70 and score&lt;80 then &quot;中等&quot;</span><br><span class="line">when score&gt;=80 and score&lt;90 then &quot;良好&quot;</span><br><span class="line">when score&gt;=90 then &quot;优秀&quot;</span><br><span class="line">end) as level</span><br><span class="line">from student;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/v2-eee3c2a24c1e14f831b96c2d14b62da0_720w.jpg" alt="img"></p>
<h2 id="汇总数据"><a href="#汇总数据" class="headerlink" title="汇总数据"></a>汇总数据</h2><h3 id="聚集函数"><a href="#聚集函数" class="headerlink" title="聚集函数"></a>聚集函数</h3><p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220426173432176.png" alt="image-20220426173432176"></p>
<h3 id="聚集不同值"><a href="#聚集不同值" class="headerlink" title="聚集不同值"></a>聚集不同值</h3><ol>
<li>对所有的行执行计算，指定ALL参数或者不给参数（默认就是计算所有）；</li>
<li>只包含不同的值，指定DISTINCT参数。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//计算商品出售的均价，去除重复值进行计算</span><br><span class="line">SELECT AVG(DISTINCT pro_price) AS avg_price</span><br><span class="line"></span><br><span class="line">FROM products</span><br><span class="line"></span><br><span class="line">WHERE pro_id = 1001;</span><br></pre></td></tr></table></figure>

<p><strong>注意：DISTINCT只能用与列一起用，指定列名的情况下能用于COUNT（）但是不可以用于COUNT（*）</strong></p>
<h3 id="组合聚集函数"><a href="#组合聚集函数" class="headerlink" title="组合聚集函数"></a>组合聚集函数</h3><p>例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT COUNT（*）num_items,</span><br><span class="line"></span><br><span class="line">MIN(pro_price) AS price_min,</span><br><span class="line"></span><br><span class="line">MAX(pro_price) AS price_max,</span><br><span class="line"></span><br><span class="line">AVG(pro_price) AS price_avg,</span><br><span class="line"></span><br><span class="line">FROM products;</span><br></pre></td></tr></table></figure>



<h2 id="分组数据"><a href="#分组数据" class="headerlink" title="分组数据"></a>分组数据</h2><h3 id="数据分组"><a href="#数据分组" class="headerlink" title="数据分组"></a>数据分组</h3><p>COUNT（）方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//统计商品1003的数量</span><br><span class="line">SELECT COUNT（*） AS num_pro</span><br><span class="line"></span><br><span class="line">FROM products</span><br><span class="line"></span><br><span class="line">WHERE pro_id = 1003;</span><br></pre></td></tr></table></figure>

<h3 id="创建分组"><a href="#创建分组" class="headerlink" title="创建分组"></a>创建分组</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//统计商品pro_id对应的商品的数量，并分组展示</span><br><span class="line">SELECT pro_id, COUNT（*） AS num_pro</span><br><span class="line"></span><br><span class="line">FROM products</span><br><span class="line"></span><br><span class="line">GROUP BY pro_id;</span><br></pre></td></tr></table></figure>

<h3 id="过滤分组"><a href="#过滤分组" class="headerlink" title="过滤分组"></a>过滤分组</h3><p> HAVING支持所有的WHERE操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//统计商品pro_id对应的商品的数量，并展示大于等于2的分组</span><br><span class="line">SELECT pro_id, COUNT（*） AS num_pro</span><br><span class="line"></span><br><span class="line">FROM products</span><br><span class="line"></span><br><span class="line">GROUP BY pro_id</span><br><span class="line"></span><br><span class="line">HAVING COUNT(*) &gt;= 2;</span><br></pre></td></tr></table></figure>

<p><strong>HAVING和WHERE的差别</strong>：这里有另一种理解方法,<strong>WHERE在数据分组前进行过滤</strong>，<strong>HAVING在数据分组后进行过滤</strong>。这是一个重要的区别，WHERE排除的行不包括在分组中。这可能会改变计算值，从而影响HAVING子句中基于这些值过滤掉的分组。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//统计商品pro_id对于的价格大于等于10的商品的数量，并展示大于等于2的分组</span><br><span class="line">SELECT pro_id, COUNT（*） AS num_pro</span><br><span class="line"></span><br><span class="line">FROM products</span><br><span class="line"></span><br><span class="line">WHERE pro_price &gt;= 10</span><br><span class="line"></span><br><span class="line">GROUP BY pro_id</span><br><span class="line"></span><br><span class="line">HAVING COUNT(*) &gt;= 2;</span><br></pre></td></tr></table></figure>

<h3 id="分组和排序"><a href="#分组和排序" class="headerlink" title="分组和排序"></a>分组和排序</h3><p>GROUP BY和ORDER BY的区别</p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220426172750492.png" alt="image-20220426172750492"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220426172836770.png" alt="image-20220426172836770"></p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//查询订单总价大于50的订单数并按总价升序排列</span><br><span class="line">SELECT 	order_num, SUM(quantity*item_price) AS ordertotal</span><br><span class="line"></span><br><span class="line">FROM orderitems</span><br><span class="line"></span><br><span class="line">GROUP BY order_num</span><br><span class="line"></span><br><span class="line">HAVING SUM(quantity*item_price) &gt;= 50;</span><br><span class="line"></span><br><span class="line">ORDER BY ordertotal;</span><br></pre></td></tr></table></figure>

<h3 id="SELECT句子顺序"><a href="#SELECT句子顺序" class="headerlink" title="SELECT句子顺序"></a>SELECT句子顺序</h3><p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220426173306255.png" alt="image-20220426173306255"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220426173318823.png" alt="image-20220426173318823"></p>
<h2 id="使用子查询"><a href="#使用子查询" class="headerlink" title="使用子查询"></a>使用子查询</h2><h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><h3 id="利用子查询进行过滤"><a href="#利用子查询进行过滤" class="headerlink" title="利用子查询进行过滤"></a>利用子查询进行过滤</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT cust_id</span><br><span class="line">FROM orders</span><br><span class="line">WHERE order_num IN (SELECT order_num</span><br><span class="line">                    FROM orderitems</span><br><span class="line">                    WHERE pro_id = &#x27;1001&#x27;);//从订单表中查找购买了id为1001的商品的顾客id</span><br></pre></td></tr></table></figure>

<p>可以多级嵌套，但是一般不推荐，因为嵌套的级数多了不利于阅读，性能也会下降</p>
<h3 id="作为计算字段使用子查询"><a href="#作为计算字段使用子查询" class="headerlink" title="作为计算字段使用子查询"></a>作为计算字段使用子查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//查找每个顾客下单的数目</span><br><span class="line">SELECT cust_name,</span><br><span class="line">	   cust_state,</span><br><span class="line">	   (SELECT COUNT(*)</span><br><span class="line">       FROM orders</span><br><span class="line">       WHERE orders.cust_id = customers.cust_id) AS orders //这里使用的相关子查询</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY cust_name;</span><br></pre></td></tr></table></figure>

<h2 id="联结表"><a href="#联结表" class="headerlink" title="联结表"></a>联结表</h2><h3 id="联结（join）"><a href="#联结（join）" class="headerlink" title="联结（join）"></a>联结（join）</h3><h4 id="关系表"><a href="#关系表" class="headerlink" title="关系表"></a>关系表</h4><p><strong>外键</strong>：外键为某个表中的一列，它包含另一个表的主键值，定义了两个表之间的关系。</p>
<p>实际开发之中并不怎么使用外键，阿里巴巴开发手册说明：</p>
<p><strong>【强制】不得使用外键与级联，一切外键概念必须在应用层解决。</strong></p>
<p>  <strong>说明: 以学生和成绩的关系为例，学生表中的 student_id 是主键，那么成绩表中的 student_id 则为外键。如果更新学生表中的 student_id，同时触发成绩表中的 student_id 更新，即为级联更新。外键与级联更新适用于单机低并发，不适合分布式、高并发集群；级联更新是强阻塞，存在数据库更新风暴的风险；外键影响数据库的插入速度。</strong></p>
<h4 id="创建联结"><a href="#创建联结" class="headerlink" title="创建联结"></a>创建联结</h4><p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT vend_name, prod_name, prod_price</span><br><span class="line"></span><br><span class="line">FROM vendors, products</span><br><span class="line"></span><br><span class="line">WHERE vendors.vend_id = products.vend_id //创建了联结，等值联结</span><br><span class="line"></span><br><span class="line">ORDER BY vend_name, prod_name;</span><br></pre></td></tr></table></figure>

<h4 id="WHERE字句的重要性"><a href="#WHERE字句的重要性" class="headerlink" title="WHERE字句的重要性"></a>WHERE字句的重要性</h4><p><strong>笛卡儿积(cartesian product)：</strong>由没有联结条件的表关系返回的结果为笛卡儿积。检索出的行的数目将是第一个表中的行数乘<br>以第二个表中的行数。</p>
<p>所以应当保证所有的联结都有WHERE字句，不然MySQL将返回比想象多得多的数据。</p>
<h4 id="内部联结"><a href="#内部联结" class="headerlink" title="内部联结"></a>内部联结</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT vend_name, prod_name, prod_price</span><br><span class="line"></span><br><span class="line">FROM vendors INNER JOIN products</span><br><span class="line"></span><br><span class="line">ON vendors.vend_id = products.vend_id //采用INNER JOIN指明了联结方式，实际效果同上</span><br><span class="line"></span><br><span class="line">ORDER BY vend_name, prod_name;</span><br></pre></td></tr></table></figure>

<h4 id="联结多个表"><a href="#联结多个表" class="headerlink" title="联结多个表"></a>联结多个表</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//显示编号为20005得到订单中的物品</span><br><span class="line">SELECT  prod_name, vend_name, prod_price, quantity</span><br><span class="line"></span><br><span class="line">FROM orderitems, products, vendors</span><br><span class="line"></span><br><span class="line">WHERE products.vend_id = vendors.vend_id</span><br><span class="line">	AND orderitems.pro_id = products.prod_id</span><br><span class="line">	AND order_num = 20005;</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong>多表连接比较消耗性能，因此一般不要联结不需要的表。</p>
<h3 id="创建高级联结"><a href="#创建高级联结" class="headerlink" title="创建高级联结"></a>创建高级联结</h3><h4 id="使用表别名"><a href="#使用表别名" class="headerlink" title="使用表别名"></a>使用表别名</h4><p><strong>优点：</strong></p>
<p><strong>缩短SQL语句</strong></p>
<p><strong>允许在单条SELECT语句中多次使用相同的表</strong></p>
<h4 id="使用不同类型的联结"><a href="#使用不同类型的联结" class="headerlink" title="使用不同类型的联结"></a>使用不同类型的联结</h4><h5 id="自联结"><a href="#自联结" class="headerlink" title="自联结"></a>自联结</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//使用子查询，查询生产1001商品的厂家的所有产品的id及name</span><br><span class="line">SELECT prod_id, prod_name</span><br><span class="line">FROM products</span><br><span class="line">WHERE vend_id = (SELECT vend_id</span><br><span class="line">				FROM products</span><br><span class="line">				WHERE pro_id = 1001);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//使用自联结，查询生产1001商品的厂家的所有产品的id及name</span><br><span class="line">SELECT p1.prod_id, p2.prod_name</span><br><span class="line">FROM products AS p1, products AS p2</span><br><span class="line">WHERE p1.vend_id = p2.vend_id</span><br><span class="line">	AND p2.prod_id = 1001;</span><br></pre></td></tr></table></figure>

<p>有些时候，使用自联结的查询效率远高于子查询，因而在确定查询语句之前，可以先尝试一下，以确认哪种查询效率更高。</p>
<h5 id="自然联结"><a href="#自然联结" class="headerlink" title="自然联结"></a>自然联结</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//使用自联结，查询生产1001商品的厂家的所有产品的id及name</span><br><span class="line">SELECT p1.prod_id, p2.prod_name</span><br><span class="line">FROM products AS p1, products AS p2</span><br><span class="line">WHERE p1.vend_id = p2.vend_id</span><br><span class="line">	AND p2.prod_id = 1001;</span><br></pre></td></tr></table></figure>

<h5 id="外部联结"><a href="#外部联结" class="headerlink" title="外部联结"></a>外部联结</h5><h5 id="使用带聚集函数的联结"><a href="#使用带聚集函数的联结" class="headerlink" title="使用带聚集函数的联结"></a>使用带聚集函数的联结</h5><p>左外联结：LEFT OUTER JOIN左边挨个查询，查不到的右边展示为NULL</p>
<p>右外联结：RIGHT OUTER JOIN右边挨个查询，查不到的左边展示为NULL</p>
<h2 id="组合查询"><a href="#组合查询" class="headerlink" title="组合查询"></a>组合查询</h2><h3 id="使用UNION"><a href="#使用UNION" class="headerlink" title="使用UNION"></a>使用UNION</h3><p>使用UNION将两个查询语句连起来，相当于执行两个不同的查询语句。注意使用UNION时列数据必须兼容，但类型不必完全相同</p>
<h3 id="对组合查询结果排序"><a href="#对组合查询结果排序" class="headerlink" title="对组合查询结果排序"></a>对组合查询结果排序</h3><p>ORDER BY只能使用一次，且必须使用在最后一个查询语句末尾。</p>
<h2 id="全文本搜索"><a href="#全文本搜索" class="headerlink" title="全文本搜索"></a>全文本搜索</h2><p><strong>并非所有引擎都支持全文本搜索：</strong>MySQL支持几种基本的数据库引擎。并非所有的引擎都支持本书所描述的全文本搜索。两个最常使用的引擎为MyISAM和InnoDB，前者支持全文本搜索，而后者不支持。这就是为什么虽然本书中创建的多数样例表使用InnoDB,而有一个样例表( productnotes表)却使用MyISAM的原因。如果你的应用中需要全文本搜索功能，应该记住这一点。</p>
<h2 id="使用全文本搜索"><a href="#使用全文本搜索" class="headerlink" title="使用全文本搜索"></a>使用全文本搜索</h2><p>为了进行全文本搜索，必须索引被搜索的列，而且要随着数据的改变不断地重新索引。在对表列进行适当设计后，MySQL会自动进行所有的索引和重新索引。<br>在索引之后，SELECT可与Match()和Against()一起使用以实际执行搜索。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220429163221315.png" alt="image-20220429163221315"></p>
<h3 id="进行全文本搜索"><a href="#进行全文本搜索" class="headerlink" title="进行全文本搜索"></a>进行全文本搜索</h3><p>在索引之后，使用两个函数Match()和Against()执行全文本搜索，其中Match()指定被搜索的列，Against()指定要使用的搜索表达式。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/用LIKE &#x27;%rabbit%&#x27;可以实现相同的效果</span><br><span class="line">SELECT note_text</span><br><span class="line">FROM products</span><br><span class="line">WHERE Match(note_text) Against(&#x27;rabbit&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220429164403537.png" alt="image-20220429164403537"></p>
<h3 id="使用查询扩展"><a href="#使用查询扩展" class="headerlink" title="使用查询扩展"></a>使用查询扩展</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT note_text</span><br><span class="line">FROM products</span><br><span class="line">WHERE Match(note_text) Against(&#x27;anvils&#x27; WITH QUERY EXPANSION);</span><br></pre></td></tr></table></figure>

<p>返回的查询结果会将含有关键词的行提前，同时返回含有关键词行词语的行，位于后面</p>
<p>注意：<strong>表中的行越多</strong>，<strong>使用扩展查询返回的结果越好</strong>。</p>
<h3 id="布尔文本搜索"><a href="#布尔文本搜索" class="headerlink" title="布尔文本搜索"></a>布尔文本搜索</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT note_text</span><br><span class="line">FROM productnotes</span><br><span class="line">WHERE Match(note_text) Against (&#x27;heavy&#x27; IN BOOLEAN MODE);//没有指定布尔操作符，所以返回值和没使用该关键词一致</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220430200247417.png" alt="image-20220430200247417"></p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//搜索包含rabbit和bait的行</span><br><span class="line">SELECT note_text</span><br><span class="line">FROM productnotes</span><br><span class="line">WHERE Match(note_text) Against (&#x27;+rabbit +bait&#x27; IN BOOLEAN MODE);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//搜索至少包含rabbit和bait之一的行</span><br><span class="line">SELECT note_text</span><br><span class="line">FROM productnotes</span><br><span class="line">WHERE Match(note_text) Against (&#x27;rabbit bait&#x27; IN BOOLEAN MODE);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//搜索包含rabbit bait这个词的行</span><br><span class="line">SELECT note_text</span><br><span class="line">FROM productnotes</span><br><span class="line">WHERE Match(note_text) Against (&#x27;&quot;rabbit bait&quot;&#x27; IN BOOLEAN MODE);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//增加rabbit的等级，降低bait的等级</span><br><span class="line">SELECT note_text</span><br><span class="line">FROM productnotes</span><br><span class="line">WHERE Match(note_text) Against (&#x27;&gt;rabbit &lt;bait&#x27; IN BOOLEAN MODE);</span><br></pre></td></tr></table></figure>

<p><strong>注意：排列而不排序</strong></p>
<p><strong><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220430200906648.png" alt="image-20220430200906648"></strong></p>
<h3 id="全文搜索的使用说明（注意）"><a href="#全文搜索的使用说明（注意）" class="headerlink" title="全文搜索的使用说明（注意）"></a>全文搜索的使用说明（注意）</h3><ol>
<li><p>在索引全文本数据时，短词被忽略且从索引中排除。短词定义为那些具有3个或3个以下字符的词(如果需要,这个数目可以更改)。</p>
</li>
<li><p>MySQL带有一个内建的非用词( stopword）列表，这些词在索引全文本数据时总是被忽略。如果需要，可以覆盖这个列表（请参[阅MySQL文档以了解如何完成此工作)。</p>
</li>
<li><p>许多词出现的频率很高，搜索它们没有用处（返回太多的结果)。因此，MySQL规定了一条50%规则，如果一个词出现在50%以上的行中,则将它作为一个非用词忽略。50%规则不用于IN BOOLEANMODE。</p>
</li>
<li><p>如果表中的行数少于3行，则全文本搜索不返回结果(因为每个词或者不出现，或者至少出现在50%的行中)。</p>
</li>
<li><p>忽略词中的单引号。例如，don’t索引为dont。</p>
</li>
<li><p>不具有词分隔符（包括日语和汉语）的语言不能恰当地返回全文本搜索结果。</p>
</li>
<li><p>如前所述，仅在MyISAM数据库引擎中支持全文本搜索。</p>
</li>
</ol>
<h2 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h2><h3 id="插入完整的行"><a href="#插入完整的行" class="headerlink" title="插入完整的行"></a>插入完整的行</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//values内的数据顺序非常重要，一旦表的结构发生改变，语句就无法使用</span><br><span class="line">INSERT INTO Curstomers</span><br><span class="line">VALUES(NULL,&#x27;tom&#x27;,18,&#x27;123456@qq.com&#x27;)</span><br></pre></td></tr></table></figure>

<p>注意：虽然这种语法很简单，但并不安全，应该尽量避免使用。上面的SQL语句高度依赖于表中列的定义次序，并且还依赖于其次序容易获得的信息。即使可得到这种次序信息，也不能保证下一次表结构变动后各个列保持完全相同的次序。因此，编写依赖于特定列次序的SQL语句是很不安全的。如果这样做，有时难免会出问题。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO Curstomers(</span><br><span class="line">	cust_name,</span><br><span class="line">    cust_age,</span><br><span class="line">    cust_email</span><br><span class="line">)</span><br><span class="line">VALUES(</span><br><span class="line">	&#x27;tom&#x27;,</span><br><span class="line">    18,</span><br><span class="line">    &#x27;123456@qq.com&#x27;);</span><br></pre></td></tr></table></figure>

<p><strong>注意：为了确保表结构改变以后语句仍然可以使用，应当使用指定列的INSERT方式</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220430202714691.png" alt="image-20220430202714691"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220430202724855.png" alt="image-20220430202724855"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220430202731474.png" alt="image-20220430202731474"></p>
<h3 id="插入多个行"><a href="#插入多个行" class="headerlink" title="插入多个行"></a>插入多个行</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//使用此方法相较于多次使用单条插入方法而言，可以大大提高插入效率</span><br><span class="line">INSERT INTO Curstomers(</span><br><span class="line">	cust_name,</span><br><span class="line">    cust_age,</span><br><span class="line">    cust_email</span><br><span class="line">)</span><br><span class="line">VALUES(</span><br><span class="line">        &#x27;tom&#x27;,</span><br><span class="line">        18,</span><br><span class="line">        &#x27;123456@qq.com&#x27;</span><br><span class="line">	),</span><br><span class="line">    (</span><br><span class="line">       &#x27;jack&#x27;,</span><br><span class="line">        20,</span><br><span class="line">        &#x27;11111@163.com&#x27;</span><br><span class="line">    ),</span><br><span class="line">    (</span><br><span class="line">        &#x27;alice&#x27;,</span><br><span class="line">        18,</span><br><span class="line">        &#x27;123@126.com&#x27;</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>

<h3 id="插入检索出的数据"><a href="#插入检索出的数据" class="headerlink" title="插入检索出的数据"></a>插入检索出的数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//将custnew表的数据插入customers表中，相应的数据类型要相兼容，MySQL并不关心列名是否一致</span><br><span class="line">INSERT INTO Curstomers(cust_id,</span><br><span class="line">    cust_name,</span><br><span class="line">    cust_age,</span><br><span class="line">    cust_email)</span><br><span class="line">SELECT 	cust_id,</span><br><span class="line">    cust_name,</span><br><span class="line">    cust_age,</span><br><span class="line">    cust_email</span><br><span class="line">FROM custnew;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220430203456770.png" alt="image-20220430203456770"></p>
<h2 id="更新和删除数据"><a href="#更新和删除数据" class="headerlink" title="更新和删除数据"></a>更新和删除数据</h2><h3 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//更新一行</span><br><span class="line">UPDATE customers</span><br><span class="line">SET cust_email = &#x27;elmer@fudd.com&#x27;</span><br><span class="line">WHERE cust_id = 10005;//没有WHERE字句时，MySQL将会使用上述值更新customers表的所有cust_email行</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//更新多行</span><br><span class="line">UPDATE customers</span><br><span class="line">SET cust_email = &#x27;elmer@fudd.com&#x27;,</span><br><span class="line">	cust_name = &#x27;tom&#x27;</span><br><span class="line">WHERE cust_id = 10005;//没有WHERE子句时，MySQL将会使用上述值更新customers表的所有cust_email行</span><br></pre></td></tr></table></figure>

<h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM customers</span><br><span class="line">WHERE cust_id = 10006;//没有WHERE子句时，删除该表中所有内容</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220430204804347.png" alt="image-20220430204804347"></p>
<h2 id="创建表和操纵表"><a href="#创建表和操纵表" class="headerlink" title="创建表和操纵表"></a>创建表和操纵表</h2><h3 id="创建表的基本操作"><a href="#创建表的基本操作" class="headerlink" title="创建表的基本操作"></a>创建表的基本操作</h3><h4 id="建表语句"><a href="#建表语句" class="headerlink" title="建表语句"></a>建表语句</h4><p>建议在创建表之前使用DROP TABLE  IF EXISTS ‘user’（删除原表）或者直接使用CREATE TABLE  IF NOT EXISTS ‘user’（判断是否存在同名表）</p>
<h4 id="使用NULL值"><a href="#使用NULL值" class="headerlink" title="使用NULL值"></a>使用NULL值</h4><p>NULL值是啥也没有，不能等同于’’；</p>
<h4 id="主键再介绍"><a href="#主键再介绍" class="headerlink" title="主键再介绍"></a>主键再介绍</h4><p>主键：唯一非空</p>
<h4 id="使用AUTO-INCREMENT"><a href="#使用AUTO-INCREMENT" class="headerlink" title="使用AUTO_INCREMENT"></a>使用AUTO_INCREMENT</h4><p>数值自增，由MySQL自动分配值，<strong>每个表只允许一个AUTO_INCREMENT列，且该列必须被索引。</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220430210252443.png" alt="image-20220430210252443"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220430210304192.png" alt="image-20220430210304192"></p>
<h4 id="指定默认值"><a href="#指定默认值" class="headerlink" title="指定默认值"></a>指定默认值</h4><p>例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE customers</span><br><span class="line">(</span><br><span class="line">    cust_id varchar(10) NOT NULL AUTO_INCREMENT,</span><br><span class="line">    cust_name char(10) NOT NULL DEFAULT &#x27;user&#x27;,//在插入值的时候若未给出，即指定为默认值</span><br><span class="line">    cust_age int NOT NULL,</span><br><span class="line">    PRIMARY KEY (cust_id)</span><br><span class="line">)ENGINE = InnoDB;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220430210821113.png" alt="image-20220430210821113"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220430210827472.png" alt="image-20220430210827472"></p>
<h4 id="引擎类型"><a href="#引擎类型" class="headerlink" title="引擎类型"></a>引擎类型</h4><p>以下是几个需要知道的引擎:</p>
<ol>
<li><p>InnoDB是一个可靠的事务处理引擎，它不支持全文本搜索;</p>
</li>
<li><p>MEMORY在功能等同于MyISAM，但由于数据存储在内存(不是磁盘）中，速度很快（特别适合于临时表);</p>
</li>
<li><p>MyISAM是一个性能极高的引擎,它支持全文本搜索，但不支持事务处理。</p>
<p>引擎可以混用，但是会带来一些麻烦：</p>
</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220430211046504.png" alt="image-20220430211046504"></p>
<h3 id="更新表"><a href="#更新表" class="headerlink" title="更新表"></a>更新表</h3><p><strong>ALTER TABLE</strong>，但是应当在数据库表建立之后尽可能少地减少对表结构的修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//给用户表增加一列</span><br><span class="line">ALTER TABLE customers</span><br><span class="line">ADD cust_phone char(20);</span><br><span class="line"></span><br><span class="line">//删除列</span><br><span class="line">ALTER TABLE customers</span><br><span class="line">DROP COLUMN cust_phone;</span><br><span class="line"></span><br><span class="line">//添加外键</span><br><span class="line">ALTER TABLE customers</span><br><span class="line">ADD CONSTRAINT fk_customers_orderitems</span><br><span class="line">FOREIGN KEY (cust_id) REFERENCES orderitems (cust_id);</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220430213328187.png" alt="image-20220430213328187"></p>
<h3 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE customer2;</span><br></pre></td></tr></table></figure>

<h3 id="重命名表"><a href="#重命名表" class="headerlink" title="重命名表"></a>重命名表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//重命名单个表</span><br><span class="line">RENAME TABLE customer2 TO customer;</span><br><span class="line"></span><br><span class="line">//重命名多个表</span><br><span class="line">RENAME TABLE customer2 TO customer,</span><br><span class="line">			 order2 TO order;</span><br></pre></td></tr></table></figure>

<h2 id="使用视图"><a href="#使用视图" class="headerlink" title="使用视图"></a>使用视图</h2><h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><p> 视图是虚拟的表。与包含数据的表不同，视图只包含使用时动态检索数据的查询。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//假设把第一次的查询包装成名为productcustomers的虚拟表</span><br><span class="line">SELECT cust_name，cust_contact</span><br><span class="line">FROM customers，orders，orderitems</span><br><span class="line">WHERE customers.cust_id = orders.cust_id</span><br><span class="line">AND orderitems.order_num = orders.order_numAND prod_id = 1001;</span><br><span class="line"></span><br><span class="line">//在这使用的productcustomers即为视图</span><br><span class="line">SELECT cust_name, cust_contact</span><br><span class="line">FROM productcustomers</span><br><span class="line">WHERE prod_id = 1001;</span><br></pre></td></tr></table></figure>

<h3 id="为什么使用视图"><a href="#为什么使用视图" class="headerlink" title="为什么使用视图"></a>为什么使用视图</h3><ol>
<li>重用SQL语句。</li>
<li>简化复杂的SQL操作。在编写查询后，可以方便地重用它而不必知道它的基本查询细节。</li>
<li>使用表的组成部分而不是整个表。</li>
<li>保护数据。可以给用户授予表的特定部分的访问权限而不是整个表的访问权限。</li>
<li>更改数据格式和表示。</li>
<li>视图可返回与底层表的表示和格式不同的数据。</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220501173129734.png" alt="image-20220501173129734"></p>
<h3 id="视图的规则和限制"><a href="#视图的规则和限制" class="headerlink" title="视图的规则和限制"></a>视图的规则和限制</h3><ol>
<li>与表一样，视图必须唯一命名（不能给视图取与别的视图或表相同的名字)。</li>
<li>对于可以创建的视图数目没有限制。</li>
<li>为了创建视图，必须具有足够的访问权限。这些限制通常由数据库管理人员授予。</li>
<li>视图可以嵌套，即可以利用从其他视图中检索数据的查询来构造一个视图。</li>
<li>ORDER BY可以用在视图中，但如果从该视图检索数据SELECT中也含有ORDER BY，那么该视图中的ORDER BY将被覆盖。</li>
<li>视图不能索引，也不能有关联的触发器或默认值。</li>
<li>视图可以和表一起使用。例如，编写一条联结表和视图的SELECT语句。</li>
</ol>
<h3 id="使用视图-1"><a href="#使用视图-1" class="headerlink" title="使用视图"></a>使用视图</h3><ol>
<li>视图用CREATE VIEw语句来创建。</li>
<li>使用SHOw CREATE VIEw viewname;来查看创建视图的语句。</li>
<li>用DROP删除视图，其语法为DROP VIEw viewname 。</li>
<li>更新视图时，可以先用DROP再用CREATE，也可以直接用CREATE ORREPLACE VIEW。如果要更新的视图不存在，则第2条更新语句会创建一个视图;如果要更新的视图存在，则第2条更新语句会替换原有视图。</li>
</ol>
<h3 id="利用视图简化复杂的联结"><a href="#利用视图简化复杂的联结" class="headerlink" title="利用视图简化复杂的联结"></a>利用视图简化复杂的联结</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//创建视图productcustomers，返回已订购任意产品的所有客户的列表</span><br><span class="line">CREATE VIEW productcustomers AS</span><br><span class="line">SELECT cust_name，cust_contact，prod_idFROM customers，orders，orderitems</span><br><span class="line">WHERE customers.cust_id = orders.cust_id</span><br><span class="line">AND orderitems. order_num = orders.order_num;</span><br><span class="line"></span><br><span class="line">//使用视图简化查询</span><br><span class="line">SELECT cust_name，cust_contactFROM productcustomers</span><br><span class="line">WHERE prod id = &#x27;TNT2 &#x27;;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220501174756178.png" alt="image-20220501174756178"></p>
<h3 id="用视图重新格式化检索出的数据"><a href="#用视图重新格式化检索出的数据" class="headerlink" title="用视图重新格式化检索出的数据"></a>用视图重新格式化检索出的数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//如果经常需要该格式的结果，不必每次在需要的时候执行联结，只需要将其转换成视图即可</span><br><span class="line">CREATE VIEW vendorlocations AS</span><br><span class="line">SELECT Concat(RTrim(vend_name)， &#x27;( &#x27;，RTrim(vend_country)，&#x27;) &#x27;) </span><br><span class="line">	   As vend_title</span><br><span class="line">FROM vendors</span><br><span class="line">ORDER BY vend_name;</span><br><span class="line"></span><br><span class="line">//直接利用视图进行检索，获取格式化后的数据</span><br><span class="line">SELECT *</span><br><span class="line">FROM vendorlocations;</span><br></pre></td></tr></table></figure>

<h3 id="用视图过滤不想要的数据"><a href="#用视图过滤不想要的数据" class="headerlink" title="用视图过滤不想要的数据"></a>用视图过滤不想要的数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//创建过滤掉cust_email为NULL的行</span><br><span class="line">CREATE VIEw customeremai11ist AS</span><br><span class="line">SELECT cust_id，cust_name，cust_emailFROM customers</span><br><span class="line">WHERE cust_email IS NOT NULL;</span><br><span class="line"></span><br><span class="line">//对视图进行检索，获取过滤后的数据</span><br><span class="line">SELECT *</span><br><span class="line">FROM customeremai11ist</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220507163841279.png" alt="image-20220507163841279"></p>
<h3 id="使用视图与计算字段"><a href="#使用视图与计算字段" class="headerlink" title="使用视图与计算字段"></a>使用视图与计算字段</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW orderitemsexpanded AS</span><br><span class="line">SELECT prod_id，</span><br><span class="line">quantity,item_price,</span><br><span class="line">quantity*item_price As expanded_price //单个物品的订单总价</span><br><span class="line">FROM orderitems</span><br><span class="line">WHERE order_num = 20005;</span><br><span class="line"></span><br><span class="line">//检索订单20005的详细内容</span><br><span class="line">SELECT *</span><br><span class="line">FROM orderitemsexpandedWHERE order_num = 20005 ;</span><br></pre></td></tr></table></figure>

<h3 id="更新视图"><a href="#更新视图" class="headerlink" title="更新视图"></a>更新视图</h3><p><strong>注意：多数视图可以更新（INSERT、UPDATE和DELETE），但是视图用于检索，并不更新</strong></p>
<p>当视图中包含一下操作时，视图被认为不可更新：</p>
<ol>
<li>分组（使用GROUP BY和HAVING）；</li>
<li>联结；</li>
<li>子查询；</li>
<li>并；</li>
<li>聚集函数（Min（）、Count（）、Sum（）等）；</li>
<li>DISTINCT；</li>
<li>导出（计算）列；</li>
</ol>
<h2 id="使用存储过程"><a href="#使用存储过程" class="headerlink" title="使用存储过程"></a>使用存储过程</h2><h3 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h3><p>存储过程简单来说，就是为以后的使用而保存的一条或多条MySQL语句的集合。可将其视为批文件，虽然它们的作用不仅限于批处理。</p>
<h3 id="为什么要使用存储过程"><a href="#为什么要使用存储过程" class="headerlink" title="为什么要使用存储过程"></a>为什么要使用存储过程</h3><ol>
<li><p>通过把处理封装在容易使用的单元中，简化复杂的操作。</p>
</li>
<li><p>由于不要求反复建立一系列处理步骤，这保证了数据的完整性。如果所有开发人员和应用程序都使用同一（试验和测试）存储过程，则所使用的代码都是相同的。</p>
<p>这一点的延伸就是防止错误。需要执行的步骤越多，出错的可能性就越大。防止错误保证了数据的一致性。</p>
</li>
<li><p>简化对变动的管理。如果表名、列名或业务逻辑（或别的内容)有变化，只需要更改存储过程的代码。使用它的人员甚至不需要知道这些变化。<br>这一点的延伸就是安全性。通过存储过程限制对基础数据的访问减少了数据讹误（无意识的或别的原因所导致的数据讹误）的机会。</p>
</li>
<li><p>提高性能。因为使用存储过程比使用单独的SQL语句要快。</p>
</li>
<li><p>存在一些只能用在单个请求中的MySQL元素和特性，存储过程可以使用它们来编写功能更强更灵活的代码。<br>换句话说，使用存储过程有3个主要的好处，即简单、安全、高性能。显然，它们都很重要。不过，在将SQL代码转换为存储过程前，也必须知道它的一些缺陷。</p>
</li>
<li><p>一般来说，存储过程的编写比基本SQL语句复杂，编写存储过程需要更高的技能，更丰富的经验。</p>
</li>
<li><p>你可能没有创建存储过程的安全访问权限。许多数据库管理员限制存储过程的创建权限，允许用户使用存储过程，但不允许他们创建存储过程。</p>
</li>
</ol>
<p>尽管有这些缺陷，存储过程还是非常有用的，并且应该尽可能地使用。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220507170400308.png" alt="image-20220507170400308"></p>
<h3 id="使用存储过程-1"><a href="#使用存储过程-1" class="headerlink" title="使用存储过程"></a>使用存储过程</h3><h4 id="执行存储过程"><a href="#执行存储过程" class="headerlink" title="执行存储过程"></a>执行存储过程</h4><p>MySQL称存储过程的执行为调用，因此MySQL执行存储过程的语句为CALL。CALL接受存储过程的名字以及需要传递给它的任意参数。请看以下例子:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//执行名为productpricing的存储过程，它计算并返回产品的最低、最高和平均价格。</span><br><span class="line">CALL productpricing(@pricelow,</span><br><span class="line">					@pricehigh,</span><br><span class="line">					@priceaverage);</span><br></pre></td></tr></table></figure>

<h4 id="创建存储过程"><a href="#创建存储过程" class="headerlink" title="创建存储过程"></a>创建存储过程</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//创建一个名为productpricing的存储过程</span><br><span class="line">CREATE PROCEDURE productpricing()</span><br><span class="line">BEGIN</span><br><span class="line">	SELECT Avg(prod_price) AS priceaverage</span><br><span class="line">	FROM products;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">//使用存储过程</span><br><span class="line">CALL productpricing();</span><br></pre></td></tr></table></figure>

<h4 id="删除存储过程"><a href="#删除存储过程" class="headerlink" title="删除存储过程"></a>删除存储过程</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP PROCEDURE productpricing;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220507194104173.png" alt="image-20220507194104173"></p>
<h4 id="使用参数"><a href="#使用参数" class="headerlink" title="使用参数"></a>使用参数</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">//该例创建的存储过程可以接受三个参数，OUT为返回值，In为需要传入的参数</span><br><span class="line">CREATE PROCEDURE productpricing(</span><br><span class="line">	OUT p1 DECIMAL(8,2),</span><br><span class="line">	OUT ph DECIMAL(8,2),</span><br><span class="line">    OUT pa DECIMAL(8,2)</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">	SELECT Min(prod_price)</span><br><span class="line">	INTO p1</span><br><span class="line">	FROM products;</span><br><span class="line">	SELECT Max(prod_price)</span><br><span class="line">	INTO ph</span><br><span class="line">	FROM products;</span><br><span class="line">	SELECT Avg(prod_price)</span><br><span class="line">	INTO pa</span><br><span class="line">	FROM products;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">//调用存储过程，采用三个变量接收返回值，同样的，如果是IN值，则需要传入参数，如CALL ordertota7 (20005,@tota1) ;</span><br><span class="line">CALL productpricing(@pricelow,</span><br><span class="line">					@pricehigh,</span><br><span class="line">					@priceaverage);</span><br><span class="line"></span><br><span class="line">//从函数返回值中获取信息</span><br><span class="line">SELECT @priceaverage;//获取单个信息</span><br><span class="line">SELECT @pricehigh,@pricelow,@priceaverage;//获取全部信息</span><br></pre></td></tr></table></figure>

<h4 id="建立智能存储过程"><a href="#建立智能存储过程" class="headerlink" title="建立智能存储过程"></a>建立智能存储过程</h4><h4 id="检查存储过程"><a href="#检查存储过程" class="headerlink" title="检查存储过程"></a>检查存储过程</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE PROCEDURE ordertotal;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220507203208398.png" alt="image-20220507203208398"></p>
<h2 id="使用游标"><a href="#使用游标" class="headerlink" title="使用游标"></a>使用游标</h2><h3 id="游标"><a href="#游标" class="headerlink" title="游标"></a>游标</h3><p>游标（cursor）是一个存储在MySQL服务器上的数据库查询，它不是一条SELECT语句，而是被该语句检索出来的结果集。在存储了游标之后，应用程序可以根据需要滚动或浏览其中的数据。</p>
<p>游标主要用于交互式应用，其中用户需要滚动屏幕上的数据，并对数据进行浏览或做出更改。</p>
<p><strong>注意：MySQL游标只能用于存储过程（和函数）。</strong></p>
<h3 id="使用游标-1"><a href="#使用游标-1" class="headerlink" title="使用游标"></a>使用游标</h3><ol>
<li>在能够使用游标前，必须声明（定义）它。这个过程实际上没有检索数据，它只是定义要使用的SELECT语句。</li>
<li>一旦声明后，必须打开游标以供使用。这个过程用前面定义的SELECT语句把数据实际检索出来。</li>
<li>对于填有数据的游标，根据需要取出（检索）各行。</li>
<li>在结束游标使用时，必须关闭游标。</li>
</ol>
<p>在声明游标后，可根据需要频繁地打开和关闭游标。在游标打开后，可根据需要频繁地执行取操作。</p>
<h4 id="创建游标"><a href="#创建游标" class="headerlink" title="创建游标"></a>创建游标</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE processorders()</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE ordernumbers CURSOR -- 采用DECLARE创建和命名游标，这里为ordernumbers</span><br><span class="line">	FOR</span><br><span class="line">	SELECT order_num FROM orders;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<h4 id="打开和关闭游标"><a href="#打开和关闭游标" class="headerlink" title="打开和关闭游标"></a>打开和关闭游标</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 游标用OPEN CURSOR语句来打开</span><br><span class="line">OPEN ordernumbers;</span><br><span class="line"></span><br><span class="line">-- 在处理OPEN语句时执行查询，存储检索出的数据以供浏览和滚动。</span><br><span class="line"></span><br><span class="line">-- 游标处理完成后，应当使用如下语句关闭游标</span><br><span class="line">CLOSE ordernumbers;</span><br></pre></td></tr></table></figure>

<p><strong>CLOSE释放游标使用的所有内部内存和资源，因此在每个游标不再需要时都应该关闭。</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220507205202020.png" alt="image-20220507205202020"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-- 这个存储过程声明、打开和关闭一个游标。但对检索出的数据什么也没做。</span><br><span class="line">CREATE PROCEDURE processorders ()</span><br><span class="line">BEGIN</span><br><span class="line">	-- Dec1are the cursor</span><br><span class="line">	DECLARE ordernumbers CURSOR</span><br><span class="line">	FOR</span><br><span class="line">	SELECT order_num FROM orders;</span><br><span class="line">	-- open the cursor</span><br><span class="line">	OPEN ordernumbers;</span><br><span class="line">	-- Close the cursorCLOSE ordernumbers;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<h4 id="使用游标数据"><a href="#使用游标数据" class="headerlink" title="使用游标数据"></a>使用游标数据</h4><p>在一个游标被打开后，可以使用FETCH语句分别访问它的每一行。FETCH指定检索什么数据（所需的列)，检索出来的数据存储在什么地方。它还向前移动游标中的内部行指针，使下一条FETCH语句检索下一行(不重复读取同一行)。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE processorders()</span><br><span class="line">BEGIN</span><br><span class="line">	-- Declare local variables</span><br><span class="line">	DECLARE o INT;</span><br><span class="line">	</span><br><span class="line">	-- Declare the cursor</span><br><span class="line">	DECLARE ordernumbers CURSOR</span><br><span class="line">	FOR</span><br><span class="line">	SELECT order_num FROM orders;</span><br><span class="line">	</span><br><span class="line">	-- Open the cursor</span><br><span class="line">	OPEN ordernumbers;</span><br><span class="line">	</span><br><span class="line">	-- Get order number</span><br><span class="line">	FETCH ordernumbers INTO o; -- FETCH用来检索当前行的order_num列(将自动从第一行开始）到一个名为o的局部声明的变量中。对检索出的数据不做任何处理。</span><br><span class="line">	</span><br><span class="line">	-- Close the cursor</span><br><span class="line">	CLOSE ordernumbers;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">-- 循环检索数据，从第一行到最后一行</span><br><span class="line">CREATE PROCEDURE processorders()</span><br><span class="line">BEGIN</span><br><span class="line"></span><br><span class="line">	-- Declare local variables</span><br><span class="line">	DECLARE done BOOLEAN DEFAULT 0; -- 默认设置done为0</span><br><span class="line">	DECLARE o INT;</span><br><span class="line">	</span><br><span class="line">	-- Dec1are the cursor</span><br><span class="line">	DECLARE ordernumbers CURSOR</span><br><span class="line">	FOR</span><br><span class="line">	SELECT order_num FROM orders;</span><br><span class="line">	-- Declare continue handler</span><br><span class="line">	DECLARE CONTINUE HANDLER FOR SQLSTATE &#x27;02000&#x27; SET done=1; -- 设置done置为1的触发条件</span><br><span class="line">	</span><br><span class="line">	-- 0pen the cursor</span><br><span class="line">	OPEN ordernumbers;</span><br><span class="line">	-- Loop through all rows</span><br><span class="line">	REPEAT</span><br><span class="line">		-- Get order number</span><br><span class="line">		FETCH ordernumbers INTO o ;</span><br><span class="line">	-- End of loop</span><br><span class="line">	UNTIL done END REPEAT;-- 当done为1时，结束循环</span><br><span class="line">	-- close the cursor</span><br><span class="line">	CLOSE ordernumbers;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220507211035380.png" alt="image-20220507211035380"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE processorders()</span><br><span class="line">BEGIN</span><br><span class="line"></span><br><span class="line">	-- Declare local variables</span><br><span class="line">	DECLARE done BOOLEAN DEFAULT 0;</span><br><span class="line">	DECLARE o INT;</span><br><span class="line">	DECLARE t DECIMAL(8,2);-- 存储每个订单的合计</span><br><span class="line"></span><br><span class="line">	-- Declare the cursor</span><br><span class="line">	DECLARE ordernumbers CURSOR</span><br><span class="line">	FOR</span><br><span class="line">	SELECT order_num FROM orders;</span><br><span class="line">	-- Declare continue handler</span><br><span class="line">	DECLARE CONTINUE HANDLER FOR SQLSTATE &#x27;02000&#x27;SET done=1;</span><br><span class="line"></span><br><span class="line">	-- Create a table to store the results</span><br><span class="line">	CREATE TABLE IF NOT EXISTS ordertotals</span><br><span class="line">		(order_num INT, tota1 DECIMAL(8,2)); -- 创建一个新表ordertotals，保存存储过程生成的结果</span><br><span class="line"></span><br><span class="line">	-- Open the cursor</span><br><span class="line">	OPEN ordernumbers;</span><br><span class="line">	</span><br><span class="line">	-- Loop through all rows</span><br><span class="line">	REPEAT</span><br><span class="line">	</span><br><span class="line">		-- Get order number</span><br><span class="line">		FETCH ordernumbers INTO o;</span><br><span class="line">		</span><br><span class="line">		-- Get the tota7 for this order</span><br><span class="line">		CALL ordertotal(o，1，t);-- 调用创建的存储过程</span><br><span class="line"></span><br><span class="line">		-- Insert order and total into ordertotals</span><br><span class="line">		INSERT INTO ordertotals(order_num，total)-- 将读取的结果存入创建的表中</span><br><span class="line">		VALUES(o，t);</span><br><span class="line">		</span><br><span class="line">		-- End of loop</span><br><span class="line">		UNTIL done END REPEAT;</span><br><span class="line">		</span><br><span class="line">		-- Close the cursor</span><br><span class="line">		CLOSE ordernumbers;</span><br><span class="line"></span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">-- 此存储过程不返回数据，但它能够创建和填充另一个表，可以用一条简单的SELECT语句查看该表</span><br><span class="line">SELECT*</span><br><span class="line">FROM ordertotals;</span><br></pre></td></tr></table></figure>

<h2 id="使用触发器"><a href="#使用触发器" class="headerlink" title="使用触发器"></a>使用触发器</h2><h3 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h3><p>触发器（Trigger）是 MySQL 中非常实用的一个功能，它可以在操作者对表进行「增删改」 之前（或之后）被触发，自动执行一段事先写好的 MySQL语句（或位于BEGIN和END语句之间的一组语句）。</p>
<p>以下是触发器的全部六种情况：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BEFORE INSERT： 在插入数据前，检测插入数据是否符合业务逻辑，如不符合返回错误信息。</span><br><span class="line">AFTER INSERT ： 在表 A 创建新账户后，将创建成功信息自动写入表 B 中。</span><br><span class="line">BEFORE UPDATE ： 在更新数据前，检测更新数据是否符合业务逻辑，如不符合返回错误信息。</span><br><span class="line">AFTER UPDATE ： 在更新数据后，将操作行为记录在 log 中</span><br><span class="line">BEFORE DELETE ： 在删除数据前，检查是否有关联数据，如有，停止删除操作。</span><br><span class="line">AFTER DELETE ： 删除表 A 信息后，自动删除表 B 中与表 A 相关联的信息。</span><br></pre></td></tr></table></figure>

<p><strong>其他的MySQL语句不支持触发器</strong></p>
<h3 id="创建触发器"><a href="#创建触发器" class="headerlink" title="创建触发器"></a>创建触发器</h3><p>在创建触发器时，需要给出以下4条信息：</p>
<ol>
<li>唯一的触发器名;</li>
<li>触发器关联的表;</li>
<li>触发器应该响应的活动（DELETE、INSERT或UPDATE);</li>
<li>触发器何时执行（处理之前或之后)。</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220507214048975.png" alt="image-20220507214048975"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 创建一个名为newproduct触发器</span><br><span class="line">CREATE TRIGGER newproduct AFTER INSERT ON products</span><br><span class="line">FOR EACH ROW SELECT &#x27;Product added &#x27;;-- Product added将对每个插入的行显示一次</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220507214728613.png" alt="image-20220507214728613"></p>
<h3 id="删除触发器"><a href="#删除触发器" class="headerlink" title="删除触发器"></a>删除触发器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP TRIGGER nweproduct;-- 触发器不能更新或者覆盖，为了修改触发器，必须删除原触发器，重新定义</span><br></pre></td></tr></table></figure>

<h3 id="使用触发器-1"><a href="#使用触发器-1" class="headerlink" title="使用触发器"></a>使用触发器</h3><h4 id="INSERT触发器"><a href="#INSERT触发器" class="headerlink" title="INSERT触发器"></a>INSERT触发器</h4><ol>
<li>在INSERT触发器代码内，可引用一个名为NEw的虚拟表，访问被插入的行;</li>
<li>在BEFORE INSERT触发器中，NEw中的值也可以被更新（允许更改被插入的值);</li>
<li>对于AUTO_INCREMENT列，NEW在INSERT执行之前包含0，在INSERT执行之后包含新的自动生成值。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER neworder AFTER INSERT ON orders</span><br><span class="line">FOR EACH ROW SELECT NEw.order_num;-- 每次返回新的订单号</span><br></pre></td></tr></table></figure>

<h4 id="DELETE触发器"><a href="#DELETE触发器" class="headerlink" title="DELETE触发器"></a>DELETE触发器</h4><ol>
<li><p>在DELETE触发器代码内，你可以引用一个名为OLD的虚拟表，访问被删除的行;</p>
</li>
<li><p>OLD中的值全都是只读的，不能更新。</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- 在任意订单被删除前将执行此触发器。它使用一条INSERT语句将oLD中的值（要被删除的订单）保存到一个名为archive_</span><br><span class="line">-- orders的存档表中（为实际使用这个例子，你需要用与orders相同的列创建一个名为archive_orders的表)。</span><br><span class="line">CREATE TRIGGER deleteorder BEFORE DELETE ON orders</span><br><span class="line">FOR EACH ROW</span><br><span class="line">BEGIN</span><br><span class="line">	INSERT INT0 archive_orders(order_num,order_date,cust_id)</span><br><span class="line">	VALUES(OLD.order_num,OLD.order_date,OLD.cust_id);</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p><strong>使用BEFOREDELETE触发器的优点（相对于AFTER DELETE触发器来说）为，如果由于某种原因，订单不能存档，DELETE本身将被放弃。</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220507215721555.png" alt="image-20220507215721555"></p>
<h4 id="UPDATE触发器"><a href="#UPDATE触发器" class="headerlink" title="UPDATE触发器"></a>UPDATE触发器</h4><ol>
<li>在UPDATE触发器代码中，你可以引用一个名为oLD的虚拟表访问以前（UPDATE语句前）的值，引用一个名为NEw的虚拟表访问新更新的值;</li>
<li>在BEFORE UPDATE触发器中，NEw中的值可能也被更新（允许更改将要用于UPDATE语句中的值);</li>
<li>OLD中的值全都是只读的，不能更新。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER updatevendor BEFORE UPDATE ON vendors</span><br><span class="line">FOR EACH ROW SET NEW.vend_state = Upper(NEW.vend_state);</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong></p>
<ol>
<li>与其他DBMS相比，MySQL5中支持的触发器相当初级。未来的MySQL版本中有一些改进和增强触发器支持的计划。</li>
<li>创建触发器可能需要特殊的安全访问权限，但是，触发器的执行是自动的。如果INSERT、UPDATE或DELETE语句能够执行，则相关的触发器也能执行。</li>
<li>应该用触发器来保证数据的一致性(大小写、格式等)。在触发器中执行这种类型的处理的优点是它总是进行这种处理，而且是透明地进行，与客户机应用无关。</li>
<li>触发器的一种非常有意义的使用是创建审计跟踪。使用触发器，把更改（如果需要，甚至还有之前和之后的状态）记录到另一个表非常容易。</li>
<li>遗憾的是，MySQL触发器中不支持CALL语句。这表示不能从触发器内调用存储过程。所需的存储过程代码需要复制到触发器内。</li>
</ol>
<h2 id="管理事务处理"><a href="#管理事务处理" class="headerlink" title="管理事务处理"></a>管理事务处理</h2><h3 id="事务处理"><a href="#事务处理" class="headerlink" title="事务处理"></a>事务处理</h3><p>MyISAM不支持明确的事务处理，而InnoDB支持；</p>
<p>事务处理可以用来维护数据库的完整性，它保证成批的MySQL要么完全执行，要么完全不执行。</p>
<p>利用事务处理，可以保证一组操作不会中途停止，它们或者作为整体执行，或者完全不执行（除非明确指示)。如果没有错误发生，整组语句提交给（写到）数据库表。如果发生错误，则进行回退（撤销）以恢复数据库到某个已知且安全的状态。</p>
<p>事务：指一组SQL语句。</p>
<p>回退：值撤销指定SQL语句的过程。</p>
<p>提交：指将为存储的SQL语句结果写入数据库表。</p>
<p>保留点：指事务处理中设置的临时占位符，你可以对它发布回退（与回退整个事务处理不同）。</p>
<h3 id="控制事务处理"><a href="#控制事务处理" class="headerlink" title="控制事务处理"></a>控制事务处理</h3><p>管理事务处理的关键在于将SQL语句组分解为逻辑块,并明确规定数据何时应该回退，何时不应该回退。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">START TRANSACTION</span><br></pre></td></tr></table></figure>

<h3 id="使用ROLLBACK"><a href="#使用ROLLBACK" class="headerlink" title="使用ROLLBACK"></a>使用ROLLBACK</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- MySQL的ROLLBACK命令用来回退（撤销）MySQL语句</span><br><span class="line">SELECT *FROM ordertotals;</span><br><span class="line">START TRANSACTION;</span><br><span class="line">DELETE FROM ordertotals;</span><br><span class="line">SELECT *FROM ordertotals;</span><br><span class="line">ROLLBACK;</span><br><span class="line">SELECT *FROM ordertotals;</span><br><span class="line">-- 显然，ROLLBACK只能在一个事务处理内使用（在执行一条STARTTRANSACTION命令之后)。</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508155845243.png" alt="image-20220508155845243"></p>
<h3 id="使用COMMIT"><a href="#使用COMMIT" class="headerlink" title="使用COMMIT"></a>使用COMMIT</h3><p>一般的MySQL语句都是直接针对数据库表执行和编写的。这就是所谓的隐含提交( implicit commit)，即提交（写或保存）操作是自动进行的。<br>但是，在事务处理块中，提交不会隐含地进行。为进行明确的提交，使用COMMIT语句，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">START TRANSACTION;</span><br><span class="line">DELETE FROM orderitems WHERE order_num = 20010;</span><br><span class="line">DELETE FROM orders WHERE order_num = 20010;</span><br><span class="line">COMMIT; -- 该语句只有在上述两条语句执行成功之后才执行，否则进行事务回滚，撤销执行成功的语句</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508160211341.png" alt="image-20220508160211341"></p>
<h3 id="使用保留点"><a href="#使用保留点" class="headerlink" title="使用保留点"></a>使用保留点</h3><p>简单的ROLLBACK和ICOMMIT语句就可以写入或撤销整个事务处理。但是，只是对简单的事务处理才能这样做，更复杂的事务处理可能需要部分提交或回退。</p>
<p>为了支持回退部分事务处理，必须能在事务处理块中合适的位置放置占位符。这样，如果需要回退，可以回退到某个占位符。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 创建保留点</span><br><span class="line">SAVEPOINT delete1;</span><br><span class="line">-- 回滚至保留点</span><br><span class="line">ROLLBACK TO delete1;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508161515324.png" alt="image-20220508161515324"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508161532113.png" alt="image-20220508161532113"></p>
<h3 id="更改默认的提交行为"><a href="#更改默认的提交行为" class="headerlink" title="更改默认的提交行为"></a>更改默认的提交行为</h3><p>正如所述，默认的MySQL行为是自动提交所有更改。换句话说，任何时候你执行一条MySQL语句，该语句实际上都是针对表执行的，而且所做的更改立即生效。为指示MySQL不自动提交更改，需要使用以下语句:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET autocommit=0; -- 指示MySQL不自动提交</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508161705287.png" alt="image-20220508161705287"></p>
<h2 id="全球化和本地化"><a href="#全球化和本地化" class="headerlink" title="全球化和本地化"></a>全球化和本地化</h2><h3 id="字符集和校对顺序"><a href="#字符集和校对顺序" class="headerlink" title="字符集和校对顺序"></a>字符集和校对顺序</h3><p>数据库表被用来存储和检索数据。不同的语言和字符集需要以不同的方式存储和检索。因此，MySQL需要适应不同的字符集（不同的字母和字符)，适应不同的排序和检索数据的方法。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508162315332.png" alt="image-20220508162315332"></p>
<h3 id="使用字符集和校对顺序"><a href="#使用字符集和校对顺序" class="headerlink" title="使用字符集和校对顺序"></a>使用字符集和校对顺序</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">-- 显示所有可用的字符集以及每个字符集的描述和默认校对</span><br><span class="line">SHOW CHARACTER SET;</span><br><span class="line"></span><br><span class="line">-- 查看所支持校对的完整列表</span><br><span class="line">SHOW COLLATION;</span><br><span class="line"></span><br><span class="line">-- 给表指定字符集和校对顺序</span><br><span class="line">CREATE TABLE mytable</span><br><span class="line">(</span><br><span class="line">	columnn1 INT,</span><br><span class="line">	columnn2 VARCHAR(10)</span><br><span class="line">)DEFAULT CHARACTER SET hebrew</span><br><span class="line">	COLLATE hebrew_general_ci;</span><br><span class="line"></span><br><span class="line">-- 给特定的列指定字符集和校对顺序</span><br><span class="line">CREATE TABLE mytable</span><br><span class="line">(</span><br><span class="line">	columnn1 INT,</span><br><span class="line">	columnn2 VARCHAR(10) ，</span><br><span class="line">	column3 VARCHAR(10) CHARACTER SET 1atin1 COLLATE latin1_genera1_ci</span><br><span class="line">) DEFAULT CHARACTER SET hebrew</span><br><span class="line">  COLLATE hebrew_general_ci;</span><br><span class="line"></span><br><span class="line">-- 指定校对顺序</span><br><span class="line">SELECT *FROM customers</span><br><span class="line">ORDER BY 1astname, firstname COLLATE 1atin1_general_cs;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508163327787.png" alt="image-20220508163327787"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508163337695.png" alt="image-20220508163337695"></p>
<p><strong>最后，值得注意的是，如果绝对需要，串可以在字符集之间进行转换。为此，使用cast()或Convert()函数。</strong></p>
<h2 id="安全管理"><a href="#安全管理" class="headerlink" title="安全管理"></a>安全管理</h2><h3 id="访问控制"><a href="#访问控制" class="headerlink" title="访问控制"></a>访问控制</h3><p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508163553743.png" alt="image-20220508163553743"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508163606430.png" alt="image-20220508163606430"></p>
<h3 id="管理用户"><a href="#管理用户" class="headerlink" title="管理用户"></a>管理用户</h3><p>MySQL用户账号和信息存储在名为mysql的MySQL数据库中。一般不需要直接访问mysql数据库和表（你稍后会明白这一点)，但有时需要直接访问。需要直接访问它的时机之一是在需要获得所有用户账号列表时。为此，可使用以下代码:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">USE mysql;</span><br><span class="line">SELECT user FROM user;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508163706267.png" alt="image-20220508163706267"></p>
<h4 id="创建用户账号"><a href="#创建用户账号" class="headerlink" title="创建用户账号"></a>创建用户账号</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 创建一个新用户账号</span><br><span class="line">CREATE USER ben IDENTIFIED BY &#x27;password&#x27; ;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508163826038.png" alt="image-20220508163826038"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508163844438.png" alt="image-20220508163844438"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508163854094.png" alt="image-20220508163854094"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 重命名用户账号</span><br><span class="line">RENAME USER ben TO bforta;</span><br></pre></td></tr></table></figure>

<h4 id="删除用户账号"><a href="#删除用户账号" class="headerlink" title="删除用户账号"></a>删除用户账号</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP USER bforta;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508164044480.png" alt="image-20220508164044480"></p>
<h4 id="设置访问权限"><a href="#设置访问权限" class="headerlink" title="设置访问权限"></a>设置访问权限</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 查看赋予用户账号的权限</span><br><span class="line">SHOW GRANTS FOR bforta;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508164158007.png" alt="image-20220508164158007"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 设置用户权限，给bforta用户赋予crashcourse数据中所有表的SELECT权限，即只读权限</span><br><span class="line">GRANT SELECT ON crashcourse.* TO bforta;</span><br><span class="line"></span><br><span class="line">-- 执行GRANT的反操作，取消授权，注意授权必须存在才能取消，否则会报错</span><br><span class="line">REVOKE SELECT ON crashcourse.*FROM bforta;</span><br></pre></td></tr></table></figure>

<p><strong>GRANT和REVOKE可在几个层次上控制访问权限：</strong></p>
<ol>
<li>整个服务器，使用GRANT ALL和REVOKE ALL;整个数据库，使用oN database.*;</li>
<li>特定的表，使用oN database.table;</li>
<li>特定的列;</li>
<li>特定的存储过程。</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508164600763.png" alt="image-20220508164600763"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508164611812.png" alt="image-20220508164611812"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508164642144.png" alt="image-20220508164642144"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/image-20220508164651866.png" alt="image-20220508164651866"></p>
<h4 id="更改口令"><a href="#更改口令" class="headerlink" title="更改口令"></a>更改口令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//设定指定用户密码</span><br><span class="line">SET PASSWORD FOR bforta = Password( &#x27;n3w p@$$wOrd &#x27; ) ;</span><br><span class="line"></span><br><span class="line">//设定当前用户密码，不指定用户</span><br><span class="line">SET PASSWORD = Password( &#x27;n3w p@$$wOrd&#x27; );</span><br></pre></td></tr></table></figure>



<h2 id="数据库维护"><a href="#数据库维护" class="headerlink" title="数据库维护"></a>数据库维护</h2><h2 id="改善性能"><a href="#改善性能" class="headerlink" title="改善性能"></a>改善性能</h2><h2 id="常见面试题汇总"><a href="#常见面试题汇总" class="headerlink" title="常见面试题汇总"></a>常见面试题汇总</h2><p>分页优化：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//limit海量数据查询卡顿</span><br><span class="line">SELECT id,uname,content FROM users ORDER BY id ASC LIMIT 500000,10;</span><br><span class="line"></span><br><span class="line">//自连接</span><br><span class="line">SELECT id,uname,content FROM  users u1 Join (SELECT id FROM user ORDER BY id ASC LIMIT 500000,10) as u2 on u1.id = u2.id;</span><br><span class="line"></span><br><span class="line">//子查询(可以用子查詢查詢id)</span><br><span class="line">SELECT * FROM users WHERE id &gt;= 500000 	ORDER BY id LIMIT 0,10;</span><br><span class="line"></span><br><span class="line">//索引</span><br><span class="line">建立索引然後走索引</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://www.cocospace.top/">Coco</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.cocospace.top/2022/04/25/MySQL/">http://www.cocospace.top/2022/04/25/MySQL/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.cocospace.top" target="_blank">cocospace</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a></div><div class="post_share"><div class="social-share" data-image="https://encylia.com/wp-content/uploads/2014/03/MySQL-Logo.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/05/26/Springboot%E6%95%B4%E5%90%88Redis%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/" title="Springboot整合Redis连接不上的几种情况"><img class="cover" src="https://www.21cto.com/uploads/article/20200702/da86590b701eb357ae392a6be7d5bea7.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Springboot整合Redis连接不上的几种情况</div></div></a></div><div class="next-post pull-right"><a href="/2022/02/20/IP%E5%8D%8F%E8%AE%AE/" title="IP协议"><img class="cover" src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/20230309221102.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">IP协议</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/02/26/MySQL%E7%B4%A2%E5%BC%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="MySQL索引底层数据结构"><img class="cover" src="https://encylia.com/wp-content/uploads/2014/03/MySQL-Logo.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-26</div><div class="title">MySQL索引底层数据结构</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://himg.bdimg.com/sys/portrait/item/public.1.c9c27b67.T8_jvMBtFmm5HndCatP7rA.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Coco</div><div class="author-info__description">一天进步一点点~</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">36</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Coco-001"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Coco-001" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:873181972@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Da Capo~24秋招加油💪</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%80%E7%B4%A2%E8%AF%AD%E5%8F%A5%EF%BC%88SELECT%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">检索语句（SELECT）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%88%97%E6%A3%80%E7%B4%A2"><span class="toc-number">1.1.</span> <span class="toc-text">单列检索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E7%B4%A2%E5%A4%9A%E4%B8%AA%E5%88%97"><span class="toc-number">1.2.</span> <span class="toc-text">检索多个列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E7%B4%A2%E6%89%80%E6%9C%89%E5%88%97"><span class="toc-number">1.3.</span> <span class="toc-text">检索所有列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E7%B4%A2%E4%B8%8D%E5%90%8C%E7%9A%84%E8%A1%8C"><span class="toc-number">1.4.</span> <span class="toc-text">检索不同的行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%90%E5%88%B6%E7%BB%93%E6%9E%9C"><span class="toc-number">1.5.</span> <span class="toc-text">限制结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%AE%8C%E5%85%A8%E9%99%90%E5%AE%9A%E7%9A%84%E8%A1%A8%E5%90%8D"><span class="toc-number">1.6.</span> <span class="toc-text">使用完全限定的表名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F%E6%A3%80%E7%B4%A2%E8%AF%AD%E5%8F%A5"><span class="toc-number">2.</span> <span class="toc-text">排序检索语句</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F%E6%95%B0%E6%8D%AE"><span class="toc-number">2.1.</span> <span class="toc-text">排序数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E5%A4%9A%E4%B8%AA%E5%88%97%E6%8E%92%E5%BA%8F"><span class="toc-number">2.2.</span> <span class="toc-text">按多个列排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E6%8E%92%E5%BA%8F%E6%96%B9%E5%90%91"><span class="toc-number">2.3.</span> <span class="toc-text">指定排序方向</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">3.</span> <span class="toc-text">过滤数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8WHERE%E5%AD%97%E5%8F%A5"><span class="toc-number">3.1.</span> <span class="toc-text">使用WHERE字句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WHERE%E5%AD%97%E5%8F%A5%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">3.2.</span> <span class="toc-text">WHERE字句操作符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%8D%95%E4%B8%AA%E5%AD%97%EF%BC%88-gt-%E3%80%81-lt-%E3%80%81-gt-x3D-%E3%80%81-lt-x3D-%E3%80%81-x3D-%E3%80%81-lt-gt-%EF%BC%89"><span class="toc-number">3.3.</span> <span class="toc-text">检查单个字（&gt;、&lt;、&gt;&#x3D;、&lt;&#x3D;、!&#x3D;、&lt;&gt;）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8C%83%E5%9B%B4%E6%A3%80%E6%9F%A5"><span class="toc-number">3.4.</span> <span class="toc-text">范围检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E5%80%BC%E6%A3%80%E6%9F%A5%EF%BC%88%E6%B3%A8%E6%84%8FNULL%E4%B8%8E%E4%B8%8D%E5%8C%B9%E9%85%8D%EF%BC%89"><span class="toc-number">3.5.</span> <span class="toc-text">空值检查（注意NULL与不匹配）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%BF%87%E6%BB%A4"><span class="toc-number">4.</span> <span class="toc-text">数据过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%90%88WHERE%E5%AD%97%E5%8F%A5"><span class="toc-number">4.1.</span> <span class="toc-text">组合WHERE字句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#AND%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">4.1.1.</span> <span class="toc-text">AND操作符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OR%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">4.1.2.</span> <span class="toc-text">OR操作符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IN%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">4.1.3.</span> <span class="toc-text">IN操作符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NOT%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">4.1.4.</span> <span class="toc-text">NOT操作符</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E9%80%9A%E9%85%8D%E7%AC%A6%E8%BF%9B%E8%A1%8C%E8%BF%87%E6%BB%A4"><span class="toc-number">4.2.</span> <span class="toc-text">用通配符进行过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LIKE%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">4.2.1.</span> <span class="toc-text">LIKE操作符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="toc-number">4.2.2.</span> <span class="toc-text">%通配符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E5%88%92%E7%BA%BF%EF%BC%8C-%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="toc-number">4.2.3.</span> <span class="toc-text">下划线，_通配符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%80%9A%E9%85%8D%E7%AC%A6%E7%9A%84%E6%8A%80%E5%B7%A7"><span class="toc-number">4.2.4.</span> <span class="toc-text">使用通配符的技巧</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BF%9B%E8%A1%8C%E6%90%9C%E7%B4%A2"><span class="toc-number">4.2.5.</span> <span class="toc-text">用正则表达式进行搜索</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8MySQL%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">4.3.</span> <span class="toc-text">使用MySQL正则表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%AD%97%E7%AC%A6%E5%8C%B9%E9%85%8D"><span class="toc-number">4.3.1.</span> <span class="toc-text">基本字符匹配</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9B%E8%A1%8COR%E5%8C%B9%E9%85%8D"><span class="toc-number">4.3.2.</span> <span class="toc-text">进行OR匹配</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E5%87%A0%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B9%8B%E4%B8%80"><span class="toc-number">4.3.3.</span> <span class="toc-text">匹配几个字符之一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E8%8C%83%E5%9B%B4"><span class="toc-number">4.3.4.</span> <span class="toc-text">匹配范围</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6"><span class="toc-number">4.3.5.</span> <span class="toc-text">匹配特殊字符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E5%AD%97%E7%AC%A6%E7%B1%BB"><span class="toc-number">4.3.6.</span> <span class="toc-text">匹配字符类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E5%A4%9A%E4%B8%AA%E5%AE%9E%E4%BE%8B"><span class="toc-number">4.3.7.</span> <span class="toc-text">匹配多个实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%BD%8D%E7%AC%A6"><span class="toc-number">4.3.8.</span> <span class="toc-text">定位符</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="toc-number">4.4.</span> <span class="toc-text">创建计算字段</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="toc-number">4.4.1.</span> <span class="toc-text">计算字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%BC%E6%8E%A5%E5%AD%97%E6%AE%B5"><span class="toc-number">4.4.2.</span> <span class="toc-text">拼接字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%88%AB%E5%90%8D"><span class="toc-number">4.4.3.</span> <span class="toc-text">使用别名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E7%AE%97%E6%95%B0%E8%AE%A1%E7%AE%97"><span class="toc-number">4.4.4.</span> <span class="toc-text">执行算数计算</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">4.5.</span> <span class="toc-text">使用函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0"><span class="toc-number">4.5.1.</span> <span class="toc-text">常见时间函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0"><span class="toc-number">4.5.2.</span> <span class="toc-text">常见数学函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%AD%97%E7%AC%A6%E5%87%BD%E6%95%B0"><span class="toc-number">4.5.3.</span> <span class="toc-text">常见字符函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%8E%A7%E5%88%B6%E5%87%BD%E6%95%B0"><span class="toc-number">4.5.4.</span> <span class="toc-text">常见控制函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B1%87%E6%80%BB%E6%95%B0%E6%8D%AE"><span class="toc-number">5.</span> <span class="toc-text">汇总数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0"><span class="toc-number">5.1.</span> <span class="toc-text">聚集函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E9%9B%86%E4%B8%8D%E5%90%8C%E5%80%BC"><span class="toc-number">5.2.</span> <span class="toc-text">聚集不同值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0"><span class="toc-number">5.3.</span> <span class="toc-text">组合聚集函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E6%95%B0%E6%8D%AE"><span class="toc-number">6.</span> <span class="toc-text">分组数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%88%86%E7%BB%84"><span class="toc-number">6.1.</span> <span class="toc-text">数据分组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%88%86%E7%BB%84"><span class="toc-number">6.2.</span> <span class="toc-text">创建分组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%88%86%E7%BB%84"><span class="toc-number">6.3.</span> <span class="toc-text">过滤分组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%92%8C%E6%8E%92%E5%BA%8F"><span class="toc-number">6.4.</span> <span class="toc-text">分组和排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SELECT%E5%8F%A5%E5%AD%90%E9%A1%BA%E5%BA%8F"><span class="toc-number">6.5.</span> <span class="toc-text">SELECT句子顺序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">7.</span> <span class="toc-text">使用子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">7.1.</span> <span class="toc-text">子查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E5%AD%90%E6%9F%A5%E8%AF%A2%E8%BF%9B%E8%A1%8C%E8%BF%87%E6%BB%A4"><span class="toc-number">7.2.</span> <span class="toc-text">利用子查询进行过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E4%B8%BA%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5%E4%BD%BF%E7%94%A8%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">7.3.</span> <span class="toc-text">作为计算字段使用子查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%94%E7%BB%93%E8%A1%A8"><span class="toc-number">8.</span> <span class="toc-text">联结表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E7%BB%93%EF%BC%88join%EF%BC%89"><span class="toc-number">8.1.</span> <span class="toc-text">联结（join）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E8%A1%A8"><span class="toc-number">8.1.1.</span> <span class="toc-text">关系表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%81%94%E7%BB%93"><span class="toc-number">8.1.2.</span> <span class="toc-text">创建联结</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WHERE%E5%AD%97%E5%8F%A5%E7%9A%84%E9%87%8D%E8%A6%81%E6%80%A7"><span class="toc-number">8.1.3.</span> <span class="toc-text">WHERE字句的重要性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E9%83%A8%E8%81%94%E7%BB%93"><span class="toc-number">8.1.4.</span> <span class="toc-text">内部联结</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%94%E7%BB%93%E5%A4%9A%E4%B8%AA%E8%A1%A8"><span class="toc-number">8.1.5.</span> <span class="toc-text">联结多个表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%AB%98%E7%BA%A7%E8%81%94%E7%BB%93"><span class="toc-number">8.2.</span> <span class="toc-text">创建高级联结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%A1%A8%E5%88%AB%E5%90%8D"><span class="toc-number">8.2.1.</span> <span class="toc-text">使用表别名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%81%94%E7%BB%93"><span class="toc-number">8.2.2.</span> <span class="toc-text">使用不同类型的联结</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%AA%E8%81%94%E7%BB%93"><span class="toc-number">8.2.2.1.</span> <span class="toc-text">自联结</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%AA%E7%84%B6%E8%81%94%E7%BB%93"><span class="toc-number">8.2.2.2.</span> <span class="toc-text">自然联结</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%96%E9%83%A8%E8%81%94%E7%BB%93"><span class="toc-number">8.2.2.3.</span> <span class="toc-text">外部联结</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%B8%A6%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0%E7%9A%84%E8%81%94%E7%BB%93"><span class="toc-number">8.2.2.4.</span> <span class="toc-text">使用带聚集函数的联结</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">9.</span> <span class="toc-text">组合查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8UNION"><span class="toc-number">9.1.</span> <span class="toc-text">使用UNION</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E6%8E%92%E5%BA%8F"><span class="toc-number">9.2.</span> <span class="toc-text">对组合查询结果排序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E6%96%87%E6%9C%AC%E6%90%9C%E7%B4%A2"><span class="toc-number">10.</span> <span class="toc-text">全文本搜索</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%85%A8%E6%96%87%E6%9C%AC%E6%90%9C%E7%B4%A2"><span class="toc-number">11.</span> <span class="toc-text">使用全文本搜索</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E8%A1%8C%E5%85%A8%E6%96%87%E6%9C%AC%E6%90%9C%E7%B4%A2"><span class="toc-number">11.1.</span> <span class="toc-text">进行全文本搜索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%9F%A5%E8%AF%A2%E6%89%A9%E5%B1%95"><span class="toc-number">11.2.</span> <span class="toc-text">使用查询扩展</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E6%96%87%E6%9C%AC%E6%90%9C%E7%B4%A2"><span class="toc-number">11.3.</span> <span class="toc-text">布尔文本搜索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E6%96%87%E6%90%9C%E7%B4%A2%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E%EF%BC%88%E6%B3%A8%E6%84%8F%EF%BC%89"><span class="toc-number">11.4.</span> <span class="toc-text">全文搜索的使用说明（注意）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">12.</span> <span class="toc-text">插入数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E5%AE%8C%E6%95%B4%E7%9A%84%E8%A1%8C"><span class="toc-number">12.1.</span> <span class="toc-text">插入完整的行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E5%A4%9A%E4%B8%AA%E8%A1%8C"><span class="toc-number">12.2.</span> <span class="toc-text">插入多个行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%A3%80%E7%B4%A2%E5%87%BA%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">12.3.</span> <span class="toc-text">插入检索出的数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%92%8C%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">13.</span> <span class="toc-text">更新和删除数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE"><span class="toc-number">13.1.</span> <span class="toc-text">更新数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">13.2.</span> <span class="toc-text">删除数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8%E5%92%8C%E6%93%8D%E7%BA%B5%E8%A1%A8"><span class="toc-number">14.</span> <span class="toc-text">创建表和操纵表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">14.1.</span> <span class="toc-text">创建表的基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BB%BA%E8%A1%A8%E8%AF%AD%E5%8F%A5"><span class="toc-number">14.1.1.</span> <span class="toc-text">建表语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8NULL%E5%80%BC"><span class="toc-number">14.1.2.</span> <span class="toc-text">使用NULL值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E5%86%8D%E4%BB%8B%E7%BB%8D"><span class="toc-number">14.1.3.</span> <span class="toc-text">主键再介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8AUTO-INCREMENT"><span class="toc-number">14.1.4.</span> <span class="toc-text">使用AUTO_INCREMENT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">14.1.5.</span> <span class="toc-text">指定默认值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%95%E6%93%8E%E7%B1%BB%E5%9E%8B"><span class="toc-number">14.1.6.</span> <span class="toc-text">引擎类型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E8%A1%A8"><span class="toc-number">14.2.</span> <span class="toc-text">更新表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A1%A8"><span class="toc-number">14.3.</span> <span class="toc-text">删除表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%91%BD%E5%90%8D%E8%A1%A8"><span class="toc-number">14.4.</span> <span class="toc-text">重命名表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%A7%86%E5%9B%BE"><span class="toc-number">15.</span> <span class="toc-text">使用视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-number">15.1.</span> <span class="toc-text">视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8%E8%A7%86%E5%9B%BE"><span class="toc-number">15.2.</span> <span class="toc-text">为什么使用视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E8%A7%84%E5%88%99%E5%92%8C%E9%99%90%E5%88%B6"><span class="toc-number">15.3.</span> <span class="toc-text">视图的规则和限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%A7%86%E5%9B%BE-1"><span class="toc-number">15.4.</span> <span class="toc-text">使用视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E8%A7%86%E5%9B%BE%E7%AE%80%E5%8C%96%E5%A4%8D%E6%9D%82%E7%9A%84%E8%81%94%E7%BB%93"><span class="toc-number">15.5.</span> <span class="toc-text">利用视图简化复杂的联结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E8%A7%86%E5%9B%BE%E9%87%8D%E6%96%B0%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A3%80%E7%B4%A2%E5%87%BA%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">15.6.</span> <span class="toc-text">用视图重新格式化检索出的数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E8%A7%86%E5%9B%BE%E8%BF%87%E6%BB%A4%E4%B8%8D%E6%83%B3%E8%A6%81%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">15.7.</span> <span class="toc-text">用视图过滤不想要的数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%A7%86%E5%9B%BE%E4%B8%8E%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="toc-number">15.8.</span> <span class="toc-text">使用视图与计算字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E8%A7%86%E5%9B%BE"><span class="toc-number">15.9.</span> <span class="toc-text">更新视图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">16.</span> <span class="toc-text">使用存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">16.1.</span> <span class="toc-text">存储过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">16.2.</span> <span class="toc-text">为什么要使用存储过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B-1"><span class="toc-number">16.3.</span> <span class="toc-text">使用存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">16.3.1.</span> <span class="toc-text">执行存储过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">16.3.2.</span> <span class="toc-text">创建存储过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">16.3.3.</span> <span class="toc-text">删除存储过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc-number">16.3.4.</span> <span class="toc-text">使用参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B%E6%99%BA%E8%83%BD%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">16.3.5.</span> <span class="toc-text">建立智能存储过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">16.3.6.</span> <span class="toc-text">检查存储过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B8%B8%E6%A0%87"><span class="toc-number">17.</span> <span class="toc-text">使用游标</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87"><span class="toc-number">17.1.</span> <span class="toc-text">游标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B8%B8%E6%A0%87-1"><span class="toc-number">17.2.</span> <span class="toc-text">使用游标</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%B8%B8%E6%A0%87"><span class="toc-number">17.2.1.</span> <span class="toc-text">创建游标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%93%E5%BC%80%E5%92%8C%E5%85%B3%E9%97%AD%E6%B8%B8%E6%A0%87"><span class="toc-number">17.2.2.</span> <span class="toc-text">打开和关闭游标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B8%B8%E6%A0%87%E6%95%B0%E6%8D%AE"><span class="toc-number">17.2.3.</span> <span class="toc-text">使用游标数据</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">18.</span> <span class="toc-text">使用触发器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">18.1.</span> <span class="toc-text">触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">18.2.</span> <span class="toc-text">创建触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">18.3.</span> <span class="toc-text">删除触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%A7%A6%E5%8F%91%E5%99%A8-1"><span class="toc-number">18.4.</span> <span class="toc-text">使用触发器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#INSERT%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">18.4.1.</span> <span class="toc-text">INSERT触发器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DELETE%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">18.4.2.</span> <span class="toc-text">DELETE触发器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#UPDATE%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">18.4.3.</span> <span class="toc-text">UPDATE触发器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86"><span class="toc-number">19.</span> <span class="toc-text">管理事务处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86"><span class="toc-number">19.1.</span> <span class="toc-text">事务处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86"><span class="toc-number">19.2.</span> <span class="toc-text">控制事务处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8ROLLBACK"><span class="toc-number">19.3.</span> <span class="toc-text">使用ROLLBACK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8COMMIT"><span class="toc-number">19.4.</span> <span class="toc-text">使用COMMIT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E4%BF%9D%E7%95%99%E7%82%B9"><span class="toc-number">19.5.</span> <span class="toc-text">使用保留点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E9%BB%98%E8%AE%A4%E7%9A%84%E6%8F%90%E4%BA%A4%E8%A1%8C%E4%B8%BA"><span class="toc-number">19.6.</span> <span class="toc-text">更改默认的提交行为</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E7%90%83%E5%8C%96%E5%92%8C%E6%9C%AC%E5%9C%B0%E5%8C%96"><span class="toc-number">20.</span> <span class="toc-text">全球化和本地化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%A0%A1%E5%AF%B9%E9%A1%BA%E5%BA%8F"><span class="toc-number">20.1.</span> <span class="toc-text">字符集和校对顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%A0%A1%E5%AF%B9%E9%A1%BA%E5%BA%8F"><span class="toc-number">20.2.</span> <span class="toc-text">使用字符集和校对顺序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86"><span class="toc-number">21.</span> <span class="toc-text">安全管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">21.1.</span> <span class="toc-text">访问控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E7%94%A8%E6%88%B7"><span class="toc-number">21.2.</span> <span class="toc-text">管理用户</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%E8%B4%A6%E5%8F%B7"><span class="toc-number">21.2.1.</span> <span class="toc-text">创建用户账号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7%E8%B4%A6%E5%8F%B7"><span class="toc-number">21.2.2.</span> <span class="toc-text">删除用户账号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90"><span class="toc-number">21.2.3.</span> <span class="toc-text">设置访问权限</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E5%8F%A3%E4%BB%A4"><span class="toc-number">21.2.4.</span> <span class="toc-text">更改口令</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%B4%E6%8A%A4"><span class="toc-number">22.</span> <span class="toc-text">数据库维护</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B9%E5%96%84%E6%80%A7%E8%83%BD"><span class="toc-number">23.</span> <span class="toc-text">改善性能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB"><span class="toc-number">24.</span> <span class="toc-text">常见面试题汇总</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/03/28/AcWing-143.%20%E6%9C%80%E5%A4%A7%E5%BC%82%E6%88%96%E5%AF%B9/" title="AcWing-143. 最大异或对"><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/a2cc7cd98d1001e93901c25dc7416cec54e736d1391b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AcWing-143. 最大异或对"/></a><div class="content"><a class="title" href="/2023/03/28/AcWing-143.%20%E6%9C%80%E5%A4%A7%E5%BC%82%E6%88%96%E5%AF%B9/" title="AcWing-143. 最大异或对">AcWing-143. 最大异或对</a><time datetime="2023-03-27T16:00:00.000Z" title="发表于 2023-03-28 00:00:00">2023-03-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/18/%E7%BE%8E%E5%9B%A23.18/" title="2023-03-18美团笔试"><img src="https://www.45fan.com/upload/2020-02-17/20021712085274495171384192.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2023-03-18美团笔试"/></a><div class="content"><a class="title" href="/2023/03/18/%E7%BE%8E%E5%9B%A23.18/" title="2023-03-18美团笔试">2023-03-18美团笔试</a><time datetime="2023-03-17T16:00:00.000Z" title="发表于 2023-03-18 00:00:00">2023-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/16/ACwing-1307.%20%E7%89%A1%E7%89%9B%E5%92%8C%E7%89%9D%E7%89%9B/" title="AcWing-1307.牡牛和牝牛"><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/a2cc7cd98d1001e93901c25dc7416cec54e736d1391b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AcWing-1307.牡牛和牝牛"/></a><div class="content"><a class="title" href="/2023/03/16/ACwing-1307.%20%E7%89%A1%E7%89%9B%E5%92%8C%E7%89%9D%E7%89%9B/" title="AcWing-1307.牡牛和牝牛">AcWing-1307.牡牛和牝牛</a><time datetime="2023-03-15T16:00:00.000Z" title="发表于 2023-03-16 00:00:00">2023-03-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/15/AcWing-200.Hankson%E7%9A%84%E8%B6%A3%E5%91%B3%E9%A2%98/" title="AcWing-200.Hankson的趣味题"><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/a2cc7cd98d1001e93901c25dc7416cec54e736d1391b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AcWing-200.Hankson的趣味题"/></a><div class="content"><a class="title" href="/2023/03/15/AcWing-200.Hankson%E7%9A%84%E8%B6%A3%E5%91%B3%E9%A2%98/" title="AcWing-200.Hankson的趣味题">AcWing-200.Hankson的趣味题</a><time datetime="2023-03-14T16:00:00.000Z" title="发表于 2023-03-15 00:00:00">2023-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/15/acwing-1290.%20%E8%B6%8A%E7%8B%B1/" title="AcWing-1290.越狱"><img src="https://cdn.jsdelivr.net/gh/Coco-001/coco/images/a2cc7cd98d1001e93901c25dc7416cec54e736d1391b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AcWing-1290.越狱"/></a><div class="content"><a class="title" href="/2023/03/15/acwing-1290.%20%E8%B6%8A%E7%8B%B1/" title="AcWing-1290.越狱">AcWing-1290.越狱</a><time datetime="2023-03-14T16:00:00.000Z" title="发表于 2023-03-15 00:00:00">2023-03-15</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2023 By Coco</div><div class="footer_custom_text">坚持下去，总会有能看到希望的那天~</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>